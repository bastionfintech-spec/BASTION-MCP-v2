<html lang="en" class="bg-[#050505] antialiased"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>BASTION LITE // TERMINAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400;500;700&display=swap');
      body { font-family: 'Inter', sans-serif; }
      .font-mono { font-family: 'JetBrains Mono', monospace; }
      /* Custom Scrollbar - Red Theme */
      .bastion-scrollbar::-webkit-scrollbar { width: 5px; height: 5px; }
      .bastion-scrollbar::-webkit-scrollbar-track { background: #09090b; }
      .bastion-scrollbar::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 2px; }
      .bastion-scrollbar::-webkit-scrollbar-thumb:hover { background: #dc2626; }
      /* Utilities */
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      .bg-grid {
      background-size: 40px 40px;
      background-image: linear-gradient(to right, #27272a 1px, transparent 1px),
      linear-gradient(to bottom, #27272a 1px, transparent 1px);
      }
      .scanline {
      background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
      background-size: 100% 4px;
      pointer-events: none;
      }
      /* Custom Toggle Switch */
      .toggle-checkbox:checked {
      right: 0;
      border-color: #dc2626;
      }
      .toggle-checkbox:checked + .toggle-label {
      background-color: #dc2626;
      }
      /* Modal Animation */
      .modal-enter { opacity: 0; transform: scale(0.95); }
      .modal-enter-active { opacity: 1; transform: scale(1); transition: opacity 0.2s, transform 0.2s; }
      .modal-exit { opacity: 1; transform: scale(1); }
      .modal-exit-active { opacity: 0; transform: scale(0.95); transition: opacity 0.2s, transform 0.2s; }
    </style>
    
  </head>
  <body class="bg-[#050505] text-zinc-400 h-screen flex flex-col overflow-hidden selection:bg-crimson-600/30 selection:text-crimson-100 relative">
    <!-- Background Effects -->
    <div class="absolute inset-0 pointer-events-none opacity-[0.03] bg-grid z-0"></div>
    <div class="absolute inset-0 pointer-events-none opacity-10 scanline z-50 mix-blend-overlay"></div>

    <!-- Header -->
    <header class="h-12 md:h-14 border-b border-zinc-800 bg-[#050505] flex items-center justify-between shrink-0 px-3 md:px-6 relative z-40">
      <!-- Left -->
      <div class="flex items-center gap-2 md:gap-4">
        <div class="flex items-center gap-2 group cursor-pointer">
          <iconify-icon icon="solar:shield-bold" class="text-crimson-600 text-lg md:text-xl group-hover:scale-110 transition-transform"></iconify-icon>
          <span class="text-base md:text-lg font-mono font-semibold tracking-tight text-white group-hover:text-crimson-600 transition-colors">
            BASTION
          </span>
          <span class="hidden md:inline text-[9px] font-mono bg-zinc-800 text-zinc-400 px-1.5 py-0.5 rounded border border-zinc-700 ml-1">
            LITE
          </span>
        </div>
      </div>

      <!-- Center (Ticker) -->
      <div class="hidden md:flex items-center gap-4 px-4 py-1.5 border border-zinc-800 bg-zinc-900/30 rounded-full backdrop-blur-sm">
        <span class="text-xs font-mono font-bold text-white">BTC-PERP</span>
        <span class="text-xs font-mono text-zinc-400">$64,240.50</span>
        <span class="text-[10px] font-mono text-green-500 bg-green-900/20 px-1 rounded flex items-center gap-1">
          <iconify-icon icon="solar:arrow-right-up-linear"></iconify-icon>
          2.4%
        </span>
      </div>

      <!-- Right -->
      <div class="flex items-center gap-6">
        <nav class="hidden md:flex items-center gap-6 text-[10px] font-mono uppercase tracking-widest">
          <a href="#" class="text-white relative after:content-[''] after:absolute after:-bottom-5 after:left-0 after:w-full after:h-0.5 after:bg-crimson-600">
            Terminal
          </a>
          <a href="#" class="text-zinc-500 hover:text-zinc-300 transition-colors">
            Research
          </a>
          <a href="#" class="text-zinc-500 hover:text-zinc-300 transition-colors">
            Account
          </a>
        </nav>
        <button class="md:hidden text-zinc-400 hover:text-white">
          <iconify-icon icon="solar:hamburger-menu-linear" width="24"></iconify-icon>
        </button>
      </div>
    </header>

    <!-- Symbol / Timeframe Bar -->
    <div class="h-10 md:h-12 border-b border-zinc-800 bg-[#080808] flex items-center shrink-0 relative z-30">
      <div class="flex-1 flex items-center overflow-x-auto no-scrollbar px-4 gap-2">
        <!-- Symbols -->
        <button class="flex items-center gap-2 px-3 py-1.5 rounded bg-crimson-600/10 border border-crimson-600/50 text-crimson-500 text-[10px] font-mono font-bold hover:bg-crimson-600/20 transition-all whitespace-nowrap">
          <iconify-icon icon="solar:star-bold" class="text-[10px]"></iconify-icon>
          BTC
        </button>
        <button class="px-3 py-1.5 rounded hover:bg-zinc-800 text-zinc-400 hover:text-white text-[10px] font-mono font-medium transition-all whitespace-nowrap">
          ETH
        </button>
        <button class="px-3 py-1.5 rounded hover:bg-zinc-800 text-zinc-400 hover:text-white text-[10px] font-mono font-medium transition-all whitespace-nowrap">
          SOL
        </button>
        <button class="px-3 py-1.5 rounded hover:bg-zinc-800 text-zinc-400 hover:text-white text-[10px] font-mono font-medium transition-all whitespace-nowrap">
          XRP
        </button>
        <button class="px-3 py-1.5 rounded hover:bg-zinc-800 text-zinc-400 hover:text-white text-[10px] font-mono font-medium transition-all whitespace-nowrap">
          BNB
        </button>
        <button class="px-3 py-1.5 rounded hover:bg-zinc-800 text-zinc-400 hover:text-white text-[10px] font-mono font-medium transition-all whitespace-nowrap">
          AVAX
        </button>

        <div class="w-px h-4 bg-zinc-800 mx-2 shrink-0"></div>

        <!-- Timeframes -->
        <button class="px-2 py-1 rounded hover:bg-zinc-800 text-zinc-500 hover:text-zinc-300 text-[10px] font-mono transition-all">
          15m
        </button>
        <button class="px-2 py-1 rounded bg-zinc-800 text-white text-[10px] font-mono font-bold transition-all border border-zinc-700">
          1H
        </button>
        <button class="px-2 py-1 rounded hover:bg-zinc-800 text-zinc-500 hover:text-zinc-300 text-[10px] font-mono transition-all">
          4H
        </button>
        <button class="px-2 py-1 rounded hover:bg-zinc-800 text-zinc-500 hover:text-zinc-300 text-[10px] font-mono transition-all">
          1D
        </button>
      </div>
    </div>

    <!-- Main Grid -->
    <main class="flex-1 grid grid-cols-1 md:grid-cols-5 min-h-0 bg-[#050505] overflow-y-auto md:overflow-hidden">
      <!-- LEFT COLUMN (Chart + Chat) -->
      <div class="md:col-span-3 flex flex-col border-b md:border-b-0 md:border-r border-zinc-800 bg-[#050505] relative z-10 overflow-hidden min-h-[55vh] md:min-h-0">
        <!-- Hero Chart -->
        <div class="absolute inset-0 z-0 bg-[#0B0B0B]">
          <div id="tv-chart" class="w-full h-full"><div class="tv-lightweight-charts" style="overflow: hidden; direction: ltr; width: 480px; height: 442px; user-select: none; -webkit-tap-highlight-color: transparent;"><table cellspacing="0" style="height: 442px; width: 480px;" class=""><tbody><tr class=""><td style="padding: 0px;"></td><td style="padding: 0px; position: relative; width: 480px; height: 414.4px;" class=""><div style="width: 100%; height: 100%; position: relative; overflow: hidden;" class=""><canvas style="width: 480px; height: 414.4px; position: absolute; z-index: 1; left: 0px; top: 0px;"></canvas><canvas style="width: 480px; height: 414.4px; position: absolute; z-index: 2; left: 0px; top: 0px;" class=""></canvas></div><style>a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}</style><a href="https://www.tradingview.com/?utm_medium=lwc-link&amp;utm_campaign=lwc-chart" title="Charting by TradingView" id="tv-attr-logo" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"></path><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"></path></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"></path></clipPath></defs></svg></a></td><td style="padding: 0px;"><div style="height: 414.4px; overflow: hidden; width: 0px; left: 0px; position: relative;"><canvas style="width: 0px; height: 414.4px; position: absolute; z-index: 1; left: 0px; top: 0px;"></canvas><canvas style="width: 0px; height: 414.4px; position: absolute; z-index: 2; left: 0px; top: 0px;"></canvas></div></td></tr><tr><td style="padding: 0px;"></td><td style="height: 28px; padding: 0px; width: 480px;"><div style="width: 100%; height: 100%; position: relative; overflow: hidden;"><canvas style="width: 480px; height: 28px; position: absolute; z-index: 1; left: 0px; top: 0px;"></canvas><canvas style="width: 480px; height: 28px; position: absolute; z-index: 2; left: 0px; top: 0px;"></canvas></div></td><td style="padding: 0px;"><div style="width: 0px; height: 28px; overflow: hidden;"><canvas style="width: 0px; height: 28px;"></canvas></div></td></tr></tbody></table></div></div>
          <div class="absolute top-4 left-4 flex gap-2 pointer-events-none z-10">
            <span class="text-[9px] font-mono bg-zinc-900/80 text-zinc-400 px-1.5 py-0.5 border border-zinc-800 rounded backdrop-blur">
              O: 64,120 H: 64,450 L: 63,900 C: 64,240
            </span>
          </div>
          <div class="absolute bottom-[80px] left-4 pointer-events-none z-10">
            <span class="flex items-center gap-1.5 text-[9px] font-mono text-crimson-500 bg-crimson-900/10 px-2 py-1 border border-crimson-900/30 rounded">
              <span class="relative flex h-1.5 w-1.5">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-crimson-500 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-1.5 w-1.5 bg-crimson-500"></span>
              </span>
              LIVE FEED
            </span>
          </div>
        </div>

        <!-- Chat Overlay -->
        <div id="chat-panel" class="absolute bottom-0 left-0 right-0 z-20 flex flex-col justify-end pointer-events-none">
          <div id="chat-backdrop" onclick="ui.toggleChat(false)" class="absolute inset-0 bg-black/60 backdrop-blur-sm opacity-0 transition-opacity pointer-events-none" style="height: 100vh; top: -100vh;"></div>
          <div id="chat-container" class="bg-[#050505]/95 border-t border-zinc-800 backdrop-blur-md shadow-[0_-10px_40px_rgba(0,0,0,0.5)] transition-transform duration-300 pointer-events-auto translate-y-0">
            <div id="chat-expanded-content" class="h-0 opacity-0 overflow-hidden transition-all duration-300 flex flex-col">
              <div class="h-6 flex items-center justify-center cursor-pointer active:bg-zinc-800/50" onclick="ui.toggleChat(false)">
                <div class="w-10 h-1 bg-zinc-700 rounded-full"></div>
              </div>
              <div class="flex-1 overflow-y-auto bastion-scrollbar p-4 space-y-4 max-h-[60vh]" id="chat-messages">
                <div class="flex gap-3 max-w-[90%]">
                  <div class="w-6 h-6 rounded bg-zinc-900 border border-zinc-800 flex items-center justify-center shrink-0 text-crimson-500">
                    <iconify-icon icon="solar:shield-bold" class="text-xs"></iconify-icon>
                  </div>
                  <div class="flex flex-col gap-1">
                    <div class="text-[10px] font-mono text-zinc-500">
                      BASTION • 10:42:05
                    </div>
                    <div class="bg-[#0B0B0B] border border-zinc-800 p-3 rounded-tr-lg rounded-b-lg text-xs leading-relaxed text-zinc-300">
                      <p>
                        Analyzing BTC-PERP structure. Price is consolidating
                        above the
                        <span class="text-white font-mono">64k support</span>
                        .
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="p-3 bg-[#080808] border-t border-zinc-800 relative safe-pb">
              <div class="flex gap-2 mb-2 overflow-x-auto no-scrollbar" id="quick-chips">
                <button class="px-2 py-1 bg-zinc-900 border border-zinc-800 rounded hover:border-crimson-600/50 text-[9px] font-mono text-zinc-400 whitespace-nowrap" onclick="window.fillPrompt('Market Outlook?')">
                  Market Outlook?
                </button>
                <button class="px-2 py-1 bg-zinc-900 border border-zinc-800 rounded hover:border-crimson-600/50 text-[9px] font-mono text-zinc-400 whitespace-nowrap" onclick="window.fillPrompt('Risk Assessment')">
                  Risk Assessment
                </button>
              </div>
              <div class="relative">
                <input type="text" id="chat-input" placeholder="Query neural engine..." class="w-full bg-[#050505] border border-zinc-800 text-xs font-mono text-white pl-3 pr-10 py-3 rounded focus:outline-none focus:border-crimson-600/50 focus:ring-1 focus:ring-crimson-900 transition-all" onfocus="ui.toggleChat(true)">
                <button class="absolute right-2 top-1/2 -translate-y-1/2 text-crimson-600 hover:text-crimson-500" onclick="api.sendChat()">
                  <iconify-icon icon="solar:plain-bold-duotone" class="text-lg"></iconify-icon>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- BASTION SHIELD FAB (Moved to Chart Frame) -->
        <div class="absolute bottom-[70px] md:bottom-[80px] right-4 md:right-6 z-40 flex flex-col-reverse items-end gap-3 pointer-events-none">
          <button onclick="ui.toggleFab()" class="pointer-events-auto hover:bg-crimson-500 flex transition-all active:scale-95 group text-white bg-crimson-600 w-12 h-12 rounded-full my-9 shadow-[0_0_20px_rgba(220,38,38,0.4)] items-center justify-center">
            <iconify-icon icon="solar:shield-bold" class="text-2xl group-hover:rotate-12 transition-transform"></iconify-icon>
          </button>
          <div id="fab-menu" class="flex flex-col gap-2 items-end transition-all duration-300 opacity-0 translate-y-4 pointer-events-none scale-95 origin-bottom-right">
            <button onclick="api.generateReport()" class="pointer-events-auto flex items-center gap-2 px-3 py-1.5 bg-[#0B0B0B] border border-zinc-800 rounded shadow-xl text-xs font-mono text-zinc-300 hover:text-white hover:border-crimson-600/50">
              Generate Report
              <iconify-icon icon="solar:document-add-linear" class="text-purple-500"></iconify-icon>
            </button>
            <button onclick="ui.switchTab('positions'); ui.toggleShield(true)" class="pointer-events-auto flex items-center gap-2 px-3 py-1.5 bg-[#0B0B0B] border border-zinc-800 rounded shadow-xl text-xs font-mono text-zinc-300 hover:text-white hover:border-crimson-600/50">
              Shield All
              <iconify-icon icon="solar:shield-check-bold" class="text-green-500"></iconify-icon>
            </button>
            <button onclick="ui.toggleChat(true)" class="pointer-events-auto flex items-center gap-2 px-3 py-1.5 bg-[#0B0B0B] border border-zinc-800 rounded shadow-xl text-xs font-mono text-zinc-300 hover:text-white hover:border-crimson-600/50">
              Ask BASTION
              <iconify-icon icon="solar:chat-line-linear" class="text-crimson-500"></iconify-icon>
            </button>
          </div>
        </div>
      </div>

      <!-- RIGHT COLUMN (Positions + Reports) -->
      <div class="md:col-span-2 flex flex-col bg-[#050505] min-h-[45vh] md:min-h-0 md:h-full overflow-hidden relative">
        <!-- Tabs -->
        <div class="h-10 border-b border-zinc-800 flex shrink-0 bg-[#080808] z-20 relative">
          <button onclick="ui.switchTab('positions')" id="tab-positions" class="flex-1 relative text-[10px] font-mono font-bold text-white bg-zinc-900/50 transition-all hover:bg-zinc-800">
            POSITIONS
            <span class="absolute bottom-0 left-0 w-full h-0.5 bg-crimson-600 transition-all" id="ind-positions"></span>
          </button>
          <button onclick="ui.switchTab('reports')" id="tab-reports" class="flex-1 relative text-[10px] font-mono font-bold text-zinc-500 transition-all hover:text-zinc-300 hover:bg-zinc-800">
            REPORTS
            <span class="absolute bottom-0 left-0 w-full h-0.5 bg-transparent transition-all" id="ind-reports"></span>
          </button>
        </div>

        <!-- Tab Content -->
        <div class="flex-1 relative overflow-hidden bg-[#050505]">
          <!-- Positions Tab -->
          <div id="view-positions" class="absolute inset-0 flex flex-col animate-[fadeIn_0.2s_ease-out]">
            <div class="flex-1 overflow-y-auto bastion-scrollbar pt-0 pr-0 pb-0 pl-0">
              <div class="p-3 border-b border-zinc-800/50 hover:bg-zinc-900/30 transition-colors group relative">
                <div class="flex justify-between items-start mb-2">
                  <div class="flex items-center gap-2">
                    <span class="font-mono font-bold text-sm text-white">
                      BTC-PERP
                    </span>
                    <span class="text-[9px] bg-green-900/20 text-green-500 border border-green-900/30 px-1 rounded uppercase font-mono">
                      Long
                    </span>
                    <span class="text-[9px] font-mono text-zinc-600">5x</span>
                  </div>
                  <span class="font-mono text-sm text-green-500 font-bold">
                    +$1,240.50
                  </span>
                </div>
                <div class="flex justify-between items-center text-[10px] font-mono text-zinc-500">
                  <span>
                    Entry:
                    <span class="text-zinc-300">62,100</span>
                  </span>
                  <span>
                    Mark:
                    <span class="text-zinc-300">64,240</span>
                  </span>
                </div>
              </div>
              <div class="p-3 border-b border-zinc-800/50 hover:bg-zinc-900/30 transition-colors group relative">
                <div class="flex justify-between items-start mb-2">
                  <div class="flex items-center gap-2">
                    <span class="font-mono font-bold text-sm text-white">
                      ETH-PERP
                    </span>
                    <span class="text-[9px] bg-red-900/20 text-red-500 border border-red-900/30 px-1 rounded uppercase font-mono">
                      Short
                    </span>
                    <span class="text-[9px] font-mono text-zinc-600">10x</span>
                  </div>
                  <span class="font-mono text-sm text-red-500 font-bold">
                    -$420.00
                  </span>
                </div>
                <div class="flex justify-between items-center text-[10px] font-mono text-zinc-500">
                  <span class="">
                    Entry:
                    <span class="text-zinc-300">3,450</span>
                  </span>
                  <span>
                    Mark:
                    <span class="text-zinc-300">3,480</span>
                  </span>
                </div>
              </div>
            </div>
            <div class="p-4 bg-[#080808] border-t border-zinc-800 shrink-0 safe-pb">
              <div class="flex items-center justify-between mb-4 bg-zinc-900/30 border border-zinc-800 p-2 rounded">
                <div class="flex items-center gap-2">
                  <iconify-icon icon="solar:shield-warning-bold" class="text-crimson-600"></iconify-icon>
                  <div class="flex flex-col">
                    <span class="text-[10px] font-mono font-bold text-white uppercase tracking-wider">
                      BASTION SHIELD
                    </span>
                    <span class="text-[8px] text-zinc-500">
                      Auto-Risk Engine
                    </span>
                  </div>
                </div>
                <div class="relative inline-block w-8 h-4">
                  <input type="checkbox" id="shield-toggle" class="toggle-checkbox absolute block w-4 h-4 rounded-full bg-white border-2 border-zinc-600 appearance-none cursor-pointer transition-all duration-300" onchange="ui.toggleShield(this.checked)">
                  <label for="shield-toggle" class="toggle-label block overflow-hidden h-4 rounded-full bg-zinc-700 cursor-pointer transition-colors duration-300"></label>
                </div>
              </div>
              <div class="flex items-end gap-8">
                <div class="flex flex-col">
                  <span class="text-[9px] font-mono text-zinc-500 uppercase">
                    Total Exposure
                  </span>
                  <span class="text-xs font-mono text-zinc-300">
                    $84,320.00
                  </span>
                </div>
                <div class="flex flex-col">
                  <span class="text-[9px] font-mono text-zinc-500 uppercase">
                    Unrealized PnL
                  </span>
                  <span class="text-sm font-mono text-green-500 font-bold">
                    +$820.50
                  </span>
                </div>
              </div>
            </div>
          </div>

          <!-- Reports Tab -->
          <div id="view-reports" class="absolute inset-0 flex flex-col hidden">
            <div class="h-10 border-b border-zinc-800 flex items-center justify-between px-4 bg-[#080808] shrink-0">
              <span class="text-[10px] font-mono font-bold text-zinc-300 uppercase">
                MCF Reports
              </span>
              <button class="flex items-center gap-1 bg-purple-900/20 hover:bg-purple-900/40 text-purple-400 border border-purple-900/40 px-2 py-0.5 rounded text-[9px] font-mono font-bold transition-all" id="btn-generate" onclick="api.generateReport()">
                <iconify-icon icon="solar:magic-stick-3-linear"></iconify-icon>
                GENERATE
              </button>
            </div>
            <div id="report-list" class="flex-1 mobile-carousel md:overflow-y-auto bastion-scrollbar p-3 md:p-0 md:space-y-0 space-x-4 md:space-x-0">
              <div onclick="document.getElementById('report-modal').classList.remove('hidden')" class="p-3 border border-zinc-800/50 md:border-b md:border-t-0 md:border-l-0 md:border-r-0 bg-zinc-900/20 md:bg-transparent hover:bg-zinc-900/40 cursor-pointer transition-colors md:border-l-2 md:border-l-transparent hover:border-l-purple-500 group h-full md:h-auto flex flex-col justify-between">
                <div>
                  <div class="flex justify-between items-start mb-1">
                    <span class="text-[9px] font-mono bg-green-900/20 text-green-500 px-1 rounded uppercase border border-green-900/30">
                      Bullish
                    </span>
                    <span class="text-[9px] font-mono text-zinc-600">
                      10m ago
                    </span>
                  </div>
                  <h4 class="text-xs font-semibold text-zinc-300 group-hover:text-white mb-2 leading-tight">
                    Institutional Flows: Q3 Accumulation
                  </h4>
                </div>
                <div class="flex gap-2">
                  <span class="text-[9px] font-mono text-zinc-500 border border-zinc-800 px-1 rounded">
                    #SOL
                  </span>
                </div>
              </div>
              <div class="p-3 border border-zinc-800/50 md:border-b md:border-t-0 md:border-l-0 md:border-r-0 bg-zinc-900/20 md:bg-transparent hover:bg-zinc-900/40 cursor-pointer transition-colors md:border-l-2 md:border-l-transparent hover:border-l-purple-500 group h-full md:h-auto flex flex-col justify-between">
                <div>
                  <div class="flex justify-between items-start mb-1">
                    <span class="text-[9px] font-mono bg-yellow-900/20 text-yellow-500 px-1 rounded uppercase border border-yellow-900/30">
                      Neutral
                    </span>
                    <span class="text-[9px] font-mono text-zinc-600">
                      2h ago
                    </span>
                  </div>
                  <h4 class="text-xs font-semibold text-zinc-300 group-hover:text-white mb-2 leading-tight">
                    Volatility Ahead of FOMC
                  </h4>
                </div>
                <div class="flex gap-2">
                  <span class="text-[9px] font-mono text-zinc-500 border border-zinc-800 px-1 rounded">
                    #BTC
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Full Screen Report Modal -->
    <div id="report-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center">
      <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="document.getElementById('report-modal').classList.add('hidden')"></div>
      <div class="relative w-full h-full md:w-[600px] md:h-[80vh] bg-[#0B0B0B] border border-zinc-800 md:rounded-lg shadow-2xl flex flex-col overflow-hidden animate-[scale_0.2s_ease-out]">
        <!-- Modal Header -->
        <div class="h-14 border-b border-zinc-800 flex items-center justify-between px-6 bg-[#0B0B0B]">
          <div class="flex items-center gap-3">
            <iconify-icon icon="solar:documents-bold" class="text-purple-500"></iconify-icon>
            <span class="text-xs font-mono font-bold text-white uppercase tracking-widest">
              MCF / REPORT_882
            </span>
          </div>
          <button onclick="document.getElementById('report-modal').classList.add('hidden')" class="text-zinc-500 hover:text-white transition-colors">
            <iconify-icon icon="solar:close-circle-linear" class="text-xl"></iconify-icon>
          </button>
        </div>

        <!-- Modal Body -->
        <div class="flex-1 overflow-y-auto bastion-scrollbar p-8 bg-[#050505]">
          <div class="flex gap-3 mb-6">
            <span class="px-2 py-0.5 bg-green-900/20 text-green-500 border border-green-900/30 text-[10px] font-mono uppercase font-bold rounded">
              Bullish
            </span>
            <span class="px-2 py-0.5 bg-zinc-900 text-zinc-500 border border-zinc-800 text-[10px] font-mono uppercase rounded">
              Confidence: 85%
            </span>
          </div>
          <h2 class="text-xl font-bold text-white mb-2 font-mono tracking-tight">
            Institutional Flows: Q3 Accumulation Patterns in L1s
          </h2>
          <div class="text-[10px] font-mono text-zinc-500 mb-8 border-b border-zinc-800 pb-4">
            Authored by
            <span class="text-zinc-300">System_V2</span>
            • 10 minutes ago
          </div>

          <div class="space-y-6 text-sm leading-7 text-zinc-300 font-light">
            <p>
              <strong class="text-white font-medium block mb-2 font-mono text-xs uppercase tracking-wide">
                1. Executive Summary
              </strong>
              Recent on-chain analysis indicates a significant divergence
              between retail sentiment and institutional wallet activity. While
              social volume remains neutral, whale tiers (&gt;1k SOL) have
              increased net holdings by 12% over the last 7 days.
            </p>
            <p>
              <strong class="text-white font-medium block mb-2 font-mono text-xs uppercase tracking-wide">
                2. Technical Confluence
              </strong>
              The 4H chart has printed a higher-low structure at the 138.50
              demand zone. Combined with the accumulation noted above, this
              suggests a high probability of a breakout attempt toward the
              162.00 liquidity pool.
            </p>

            <div class="bg-zinc-900/30 border border-zinc-800 p-4 rounded-sm my-4">
              <div class="flex justify-between items-center mb-2">
                <span class="text-[10px] font-mono text-zinc-500 uppercase">
                  Model Output
                </span>
                <iconify-icon icon="solar:cpu-linear" class="text-purple-500"></iconify-icon>
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <div class="text-[9px] text-zinc-600 uppercase">Target 1</div>
                  <div class="text-sm font-mono text-green-500">162.00</div>
                </div>
                <div>
                  <div class="text-[9px] text-zinc-600 uppercase">
                    Invalidation
                  </div>
                  <div class="text-sm font-mono text-red-500">132.50</div>
                </div>
              </div>
            </div>

            <p>
              <strong class="text-white font-medium block mb-2 font-mono text-xs uppercase tracking-wide">
                3. Risk Factors
              </strong>
              Macro correlation remains high. A sudden spike in DXY could dampen
              the breakout. Watch for BTC dominance rejection at 58% as a
              confirmation signal for Alt L1 rotation.
            </p>
          </div>
        </div>
      </div>
    </div>

    <script>
      (function(){const n=function(){};if(location.hostname!=='localhost'&&location.hostname!=='127.0.0.1'){console.log=n;console.debug=n;console.info=n;console.warn=n}})();

      // API Module
      const api = {
        getKlines: async (sym) => {
            const data = [], vol = [];
            let price = 64240, date = new Date(); date.setHours(date.getHours() - 200);
            for (let i=0; i<200; i++) {
                const open = price, close = price + (Math.random()-0.5)*200;
                const time = date.getTime()/1000; date.setHours(date.getHours()+1);
                data.push({ time, open, high: Math.max(open,close)+Math.random()*50, low: Math.min(open,close)-Math.random()*50, close });
                vol.push({ time, volume: Math.random()*1000000+500000 });
                price = close;
            }
            return { candles: data.map((d,i) => ({...d, volume: vol[i].volume})) };
        },
        sendChat: async () => {
            const input = document.getElementById('chat-input');
            const val = input.value.trim();
            if (!val) return;
            const box = document.getElementById('chat-messages');
            box.insertAdjacentHTML('beforeend', `<div class="flex gap-3 max-w-[80%] ml-auto flex-row-reverse"><div class="w-6 h-6 rounded bg-zinc-800 border border-zinc-700 flex items-center justify-center shrink-0 text-white"><iconify-icon icon="solar:user-circle-bold" class="text-xs"></iconify-icon></div><div class="flex flex-col gap-1 items-end"><div class="text-[10px] font-mono text-zinc-500">YOU • Now</div><div class="bg-crimson-900/20 border border-crimson-600/30 p-3 rounded-tl-lg rounded-b-lg text-xs leading-relaxed text-zinc-200">${val}</div></div></div>`);
            input.value = '';
            ui.scrollToBottom();
            setTimeout(() => {
                box.insertAdjacentHTML('beforeend', `<div class="flex gap-3 max-w-[90%]"><div class="w-6 h-6 rounded bg-zinc-900 border border-zinc-800 flex items-center justify-center shrink-0 text-crimson-500"><iconify-icon icon="solar:shield-bold" class="text-xs"></iconify-icon></div><div class="flex flex-col gap-1"><div class="text-[10px] font-mono text-zinc-500">BASTION • Now</div><div class="bg-[#0B0B0B] border border-zinc-800 p-3 rounded-tr-lg rounded-b-lg text-xs leading-relaxed text-zinc-300">Response processed for "${val}". Neural engine active.</div></div></div>`);
                ui.scrollToBottom();
            }, 800);
        },
        generateReport: async () => {
            const btn = document.getElementById('btn-generate');
            const original = btn.innerHTML;
            btn.innerHTML = '<iconify-icon icon="svg-spinners:ring-resize"></iconify-icon> GEN...';
            await new Promise(r => setTimeout(r, 1000));
            btn.innerHTML = original;
            const list = document.getElementById('report-list');
            const el = document.createElement('div');
            el.className = 'p-3 border border-zinc-800/50 bg-zinc-900/20 md:bg-transparent md:border-b md:border-t-0 md:border-l-0 md:border-r-0 hover:bg-zinc-900/40 cursor-pointer transition-colors md:border-l-2 md:border-l-transparent hover:border-l-purple-500 group h-full md:h-auto flex flex-col justify-between shrink-0 w-[85%] md:w-full animate-[fadeIn_0.3s_ease-out] snap-center';
            el.innerHTML = `<div class="mb-1"><div class="flex justify-between items-start mb-1"><span class="text-[9px] font-mono bg-purple-900/20 text-purple-500 px-1 rounded uppercase border border-purple-900/30">New</span><span class="text-[9px] font-mono text-zinc-600">Now</span></div><h4 class="text-xs font-semibold text-zinc-300 group-hover:text-white mb-2 leading-tight">Institutional Flows: Buy Wall Detected</h4></div><div class="flex gap-2"><span class="text-[9px] font-mono text-zinc-500 border border-zinc-800 px-1 rounded">#FLOW</span></div>`;
            list.prepend(el);
            ui.switchTab('reports');
        }
      };

      // UI Module
      const ui = {
        tabs: { positions: document.getElementById('view-positions'), reports: document.getElementById('view-reports') },
        buttons: { positions: document.getElementById('tab-positions'), reports: document.getElementById('tab-reports') },
        switchTab: (tab) => {
            Object.values(ui.tabs).forEach(el => el.classList.add('hidden'));
            ui.tabs[tab].classList.remove('hidden');
            // Update indicators
            document.getElementById('ind-positions').classList.replace(tab==='positions'?'bg-transparent':'bg-crimson-600', tab==='positions'?'bg-crimson-600':'bg-transparent');
            document.getElementById('ind-reports').classList.replace(tab==='reports'?'bg-transparent':'bg-purple-600', tab==='reports'?'bg-purple-600':'bg-transparent');
            // Update Text Colors
            ui.buttons.positions.className = tab==='positions' ? 'flex-1 relative text-[10px] font-mono font-bold text-white bg-zinc-900/50 transition-all' : 'flex-1 relative text-[10px] font-mono font-bold text-zinc-500 transition-all hover:text-zinc-300';
            ui.buttons.reports.className = tab==='reports' ? 'flex-1 relative text-[10px] font-mono font-bold text-white bg-zinc-900/50 transition-all' : 'flex-1 relative text-[10px] font-mono font-bold text-zinc-500 transition-all hover:text-zinc-300';
        },
        toggleChat: (open) => {
            const backdrop = document.getElementById('chat-backdrop');
            const content = document.getElementById('chat-expanded-content');
            if (open) {
               backdrop.style.opacity = '1';
               backdrop.style.pointerEvents = 'auto';
               content.classList.remove('h-0', 'opacity-0');
               content.classList.add('h-auto', 'opacity-100');
               setTimeout(() => ui.scrollToBottom(), 300);
            } else {
               backdrop.style.opacity = '0';
               backdrop.style.pointerEvents = 'none';
               content.classList.add('h-0', 'opacity-0');
               content.classList.remove('h-auto', 'opacity-100');
            }
        },
        toggleFab: () => {
            const menu = document.getElementById('fab-menu');
            const isOpen = menu.style.opacity === '1';
            menu.style.opacity = isOpen ? '0' : '1';
            menu.style.pointerEvents = isOpen ? 'none' : 'auto';
            menu.style.transform = isOpen ? 'translateY(1rem) scale(0.95)' : 'translateY(0) scale(1)';
        },
        toggleShield: (active) => {
             // Mock shield toggle
             const badges = document.querySelectorAll('.group'); // targeting cards
             // Visual feedback only for demo
        },
        scrollToBottom: () => {
             const box = document.getElementById('chat-messages');
             box.scrollTop = box.scrollHeight;
        }
      };

      // Helpers
      window.fillPrompt = (txt) => { document.getElementById('chat-input').value = txt; ui.toggleChat(true); };
      window.ui = ui; window.api = api;

      // Init Chart
      document.addEventListener('DOMContentLoaded', async () => {
          const container = document.getElementById('tv-chart');
          const chart = LightweightCharts.createChart(container, {
              layout: { background: { color: '#0B0B0B' }, textColor: '#71717a' },
              grid: { vertLines: { color: '#18181b' }, horzLines: { color: '#18181b' } },
              crosshair: { mode: LightweightCharts.CrosshairMode.Normal },
              rightPriceScale: { borderColor: '#27272a' },
              timeScale: { borderColor: '#27272a', timeVisible: true },
          });
          const candleSeries = chart.addCandlestickSeries({ upColor: '#22c55e', downColor: '#ef4444', borderVisible: false, wickUpColor: '#22c55e', wickDownColor: '#ef4444' });
          new ResizeObserver(e => { if(e[0].contentRect) chart.applyOptions({ width: e[0].contentRect.width, height: e[0].contentRect.height }) }).observe(container);

          const data = await api.getKlines();
          candleSeries.setData(data.candles);
      });
    </script>
  
</body></html>