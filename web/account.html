<html lang="en" class="bg-[#050505] scroll-smooth antialiased"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BASTION - Account Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <script src="settings.js"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=JetBrains+Mono:wght@400;500;700&family=Space+Grotesk:wght@400;500;600;700&display=swap');
      body { font-family: 'Inter', sans-serif; }
      .font-mono { font-family: 'JetBrains Mono', monospace; }
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      .tactical-grid {
        background-size: 40px 40px;
        background-image:
          linear-gradient(to right, rgba(220, 38, 38, 0.07) 1px, transparent 1px),
          linear-gradient(to bottom, rgba(220, 38, 38, 0.07) 1px, transparent 1px);
        mask-image: radial-gradient(ellipse at center top, black 40%, transparent 80%);
        -webkit-mask-image: radial-gradient(ellipse at center top, black 40%, transparent 80%);
        pointer-events: none;
        z-index: 1;
      }
      .scanlines {
        background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.3) 50%, rgba(0,0,0,0.3));
        background-size: 100% 3px;
        pointer-events: none;
        z-index: 50;
        opacity: 0.3;
      }
      .toggle-on { background: linear-gradient(135deg, #DC2626 0%, #991B1B 100%); }
      .toggle-off { background: #27272a; }
      .slider-thumb::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 16px;
        height: 16px;
        background: #DC2626;
        border-radius: 50%;
        cursor: pointer;
        border: 2px solid #fff;
      }
      .slider-thumb::-moz-range-thumb {
        width: 16px;
        height: 16px;
        background: #DC2626;
        border-radius: 50%;
        cursor: pointer;
        border: 2px solid #fff;
      }
      .plan-card:hover { transform: translateY(-2px); }
      .plan-card.active { border-color: #DC2626; box-shadow: 0 0 30px rgba(220, 38, 38, 0.2); }
    </style>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'crimson': {
                400: '#F87171', 500: '#EF4444', 600: '#DC2626', 700: '#B91C1C', 900: '#7F1D1D', 950: '#450A0A'
              },
              'zinc': {
                850: '#1f1f22', 900: '#18181b', 950: '#09090b',
              }
            }
          }
        }
      };
    </script>
</head>
<body class="text-zinc-400 min-h-screen flex flex-col selection:bg-crimson-600 selection:text-white bg-[#050505] overflow-x-auto font-sans">
    <!-- CRIMSON ENERGY BEAM -->
    <div class="fixed top-0 left-1/2 -translate-x-1/2 w-[1200px] h-[600px] bg-gradient-to-b from-zinc-600/15 via-crimson-900/10 to-transparent blur-[100px] rounded-full pointer-events-none z-0 mix-blend-screen opacity-80"></div>
    <div class="fixed top-[-100px] left-1/2 -translate-x-1/2 w-[600px] h-[300px] bg-zinc-500/10 blur-[80px] rounded-full pointer-events-none z-0 mix-blend-screen"></div>

    <!-- Tactical Grid Overlay -->
    <div class="fixed inset-0 tactical-grid pointer-events-none z-0"></div>

    <!-- Scanlines Overlay -->
    <div class="fixed inset-0 pointer-events-none z-50 scanlines mix-blend-overlay"></div>

    <main class="flex-1 flex flex-col min-h-screen font-sans z-10 relative">
      <div class="w-full h-full bg-[#0A0A0A] border-t border-zinc-800 relative flex-1 flex flex-col">
        <!-- Scanline overlay -->
        <div class="absolute inset-0 pointer-events-none z-50 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.1)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] bg-[length:100%_2px,3px_100%] bg-repeat opacity-20 mix-blend-overlay"></div>

        <!-- TERMINAL TOP BAR -->
        <div class="bg-zinc-900/90 border-b border-zinc-800 p-2 flex items-center justify-between gap-4 text-[10px] font-mono select-none relative z-20 border-l-2 border-zinc-600">
          <!-- Left -->
          <div class="flex items-center gap-6">
            <a href="/" class="flex items-center gap-2 font-bold text-white tracking-tighter text-sm hover:text-crimson-500 transition-colors">
              <iconify-icon icon="solar:shield-bold" class="text-crimson-600"></iconify-icon>
              BASTION
            </a>
            <div class="flex items-center gap-2 px-3 py-1 bg-zinc-800/50 border border-zinc-700/50 rounded text-zinc-400">
              <iconify-icon icon="solar:user-circle-bold" class="text-lg"></iconify-icon>
              ACCOUNT CENTER
            </div>
          </div>

          <!-- Center - Navigation -->
          <div class="flex items-center gap-1 border border-zinc-800 rounded bg-zinc-900/50">
            <a href="/" class="px-4 py-1.5 text-zinc-400 hover:text-white hover:bg-zinc-800/50 transition-all rounded-l">
              <iconify-icon icon="solar:chart-bold" class="mr-1"></iconify-icon>TERMINAL
            </a>
            <a href="/visualizations" class="px-4 py-1.5 text-zinc-400 hover:text-white hover:bg-zinc-800/50 transition-all">
              <iconify-icon icon="solar:graph-new-bold" class="mr-1"></iconify-icon>3D VIZ
            </a>
            <a href="/research" class="px-4 py-1.5 text-zinc-400 hover:text-white hover:bg-zinc-800/50 transition-all">
              <iconify-icon icon="solar:document-text-bold" class="mr-1"></iconify-icon>RESEARCH
            </a>
            <div class="px-4 py-1.5 text-white bg-zinc-700/30 border-l border-r border-zinc-600/50">
              <iconify-icon icon="solar:user-circle-bold" class="mr-1"></iconify-icon>ACCOUNT
            </div>
          </div>

          <!-- Right -->
          <div class="flex items-center gap-4">
            <div class="text-zinc-500" id="current-time">--:--:-- UTC</div>
          </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="flex-1 flex overflow-hidden">
          <!-- SIDEBAR - SETTINGS NAVIGATION -->
          <div class="w-64 bg-[#0B0B0B] border-r border-zinc-800 flex flex-col">
            <div class="p-4 border-b border-zinc-800">
              <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-full bg-gradient-to-br from-crimson-600 to-crimson-900 flex items-center justify-center text-white font-bold text-lg" id="user-avatar">
                  T
                </div>
                <div>
                  <div class="text-[12px] text-white font-bold" id="user-display-name">Trader</div>
                  <div class="text-[10px] text-crimson-400" id="user-tier">PRO TIER</div>
                </div>
              </div>
            </div>
            
            <div class="flex-1 overflow-y-auto no-scrollbar p-2">
              <div class="text-[9px] text-zinc-600 uppercase tracking-wider px-2 mb-2">Settings</div>
              
              <button class="sidebar-btn w-full text-left px-3 py-2 rounded text-[11px] bg-crimson-600/20 text-crimson-400 border border-crimson-600/30 mb-1 flex items-center gap-2" data-tab="exchanges">
                <iconify-icon icon="solar:link-circle-bold"></iconify-icon>
                Exchange Connections
              </button>
              
              <button class="sidebar-btn w-full text-left px-3 py-2 rounded text-[11px] text-zinc-400 hover:bg-zinc-800/50 hover:text-white transition-colors mb-1 flex items-center gap-2" data-tab="alerts">
                <iconify-icon icon="solar:bell-bold"></iconify-icon>
                Alert Preferences
              </button>
              
              <button class="sidebar-btn w-full text-left px-3 py-2 rounded text-[11px] text-zinc-400 hover:bg-zinc-800/50 hover:text-white transition-colors mb-1 flex items-center gap-2" data-tab="risk">
                <iconify-icon icon="solar:shield-warning-bold"></iconify-icon>
                Risk Settings
              </button>
              
              <button class="sidebar-btn w-full text-left px-3 py-2 rounded text-[11px] text-zinc-400 hover:bg-zinc-800/50 hover:text-white transition-colors mb-1 flex items-center gap-2" data-tab="appearance">
                <iconify-icon icon="solar:palette-bold"></iconify-icon>
                Appearance
              </button>
              
              <button class="sidebar-btn w-full text-left px-3 py-2 rounded text-[11px] text-zinc-400 hover:bg-zinc-800/50 hover:text-white transition-colors mb-1 flex items-center gap-2" data-tab="subscription">
                <iconify-icon icon="solar:crown-bold"></iconify-icon>
                Subscription
              </button>
              
              <div class="text-[9px] text-zinc-600 uppercase tracking-wider px-2 mb-2 mt-4">Account</div>
              
              <button class="sidebar-btn w-full text-left px-3 py-2 rounded text-[11px] text-zinc-400 hover:bg-zinc-800/50 hover:text-white transition-colors mb-1 flex items-center gap-2" data-tab="profile">
                <iconify-icon icon="solar:user-bold"></iconify-icon>
                Profile
              </button>
              
              <button class="sidebar-btn w-full text-left px-3 py-2 rounded text-[11px] text-zinc-400 hover:bg-zinc-800/50 hover:text-white transition-colors mb-1 flex items-center gap-2" data-tab="security">
                <iconify-icon icon="solar:lock-password-bold"></iconify-icon>
                Security
              </button>
              
              <button class="w-full text-left px-3 py-2 rounded text-[11px] text-crimson-400 hover:bg-crimson-900/30 transition-colors mb-1 flex items-center gap-2 mt-4" onclick="signOut()">
                <iconify-icon icon="solar:logout-2-bold"></iconify-icon>
                Sign Out
              </button>
            </div>
            
            <!-- Storage Usage -->
            <div class="p-3 border-t border-zinc-800">
              <div class="text-[9px] text-zinc-500 uppercase mb-2">API Usage This Month</div>
              <div class="h-1.5 bg-zinc-800 rounded-full overflow-hidden mb-1">
                <div class="h-full bg-gradient-to-r from-crimson-600 to-crimson-400 rounded-full" style="width: 34%"></div>
              </div>
              <div class="text-[9px] text-zinc-500">2,720 / 8,000 calls</div>
            </div>
          </div>

          <!-- MAIN SETTINGS PANEL -->
          <div class="flex-1 overflow-y-auto no-scrollbar p-6 bg-[#090909]">
            
            <!-- ==================== EXCHANGE CONNECTIONS TAB ==================== -->
            <div id="tab-exchanges" class="tab-content">
              <div class="max-w-4xl">
                <div class="mb-6">
                  <h1 class="text-xl text-white font-bold mb-1">Exchange Connections</h1>
                  <p class="text-[11px] text-zinc-500">Connect your exchange API keys to load live positions and enable trading features.</p>
                </div>
                
                <!-- Security Notice -->
                <div class="bg-amber-900/20 border border-amber-800/50 rounded-lg p-4 mb-6">
                  <div class="flex items-start gap-3">
                    <iconify-icon icon="solar:shield-warning-bold" class="text-amber-500 text-xl mt-0.5"></iconify-icon>
                    <div>
                      <div class="text-[12px] text-amber-400 font-bold mb-1">Security Notice</div>
                      <div class="text-[10px] text-amber-200/70 leading-relaxed">
                        Your API keys are encrypted and stored securely. We recommend using <span class="text-white font-bold">read-only</span> keys unless you need to execute trades. 
                        Never share your API secret with anyone. Enable IP whitelisting on your exchange for maximum security.
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Connected Exchanges -->
                <div class="mb-6">
                  <div class="text-[11px] text-zinc-400 uppercase tracking-wider mb-3">Connected Exchanges</div>
                  
                  <div id="connected-exchanges" class="space-y-3">
                    <div class="bg-zinc-900/50 border border-zinc-800 rounded-lg p-4 text-center">
                      <iconify-icon icon="solar:link-broken-linear" class="text-3xl text-zinc-600 mb-2"></iconify-icon>
                      <div class="text-[11px] text-zinc-500">No exchanges connected yet</div>
                      <div class="text-[10px] text-zinc-600">Add an exchange below to get started</div>
                    </div>
                  </div>
                </div>
                
                <!-- Add New Exchange -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5">
                  <div class="text-[13px] text-white font-bold mb-4">Add Exchange Connection</div>
                  
                  <div class="grid grid-cols-3 gap-3 mb-6">
                    <button class="exchange-btn p-4 bg-zinc-900 border-2 border-zinc-800 rounded-lg hover:border-crimson-600/50 hover:bg-zinc-900/80 transition-all text-center group" data-exchange="blofin">
                      <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">ðŸ”µ</div>
                      <div class="text-[11px] text-white font-bold">BloFin</div>
                      <div class="text-[9px] text-zinc-500">Derivatives</div>
                    </button>
                    
                    <button class="exchange-btn p-4 bg-zinc-900 border-2 border-zinc-800 rounded-lg hover:border-crimson-600/50 hover:bg-zinc-900/80 transition-all text-center group" data-exchange="bitunix">
                      <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">ðŸŸ£</div>
                      <div class="text-[11px] text-white font-bold">Bitunix</div>
                      <div class="text-[9px] text-zinc-500">Derivatives</div>
                    </button>
                    
                    <button class="exchange-btn p-4 bg-zinc-900 border-2 border-zinc-800 rounded-lg hover:border-crimson-600/50 hover:bg-zinc-900/80 transition-all text-center group" data-exchange="bybit">
                      <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">ðŸŸ¡</div>
                      <div class="text-[11px] text-white font-bold">Bybit</div>
                      <div class="text-[9px] text-zinc-500">Derivatives & Spot</div>
                    </button>
                    
                    <button class="exchange-btn p-4 bg-zinc-900 border-2 border-zinc-800 rounded-lg hover:border-crimson-600/50 hover:bg-zinc-900/80 transition-all text-center group" data-exchange="okx">
                      <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">âš«</div>
                      <div class="text-[11px] text-white font-bold">OKX</div>
                      <div class="text-[9px] text-zinc-500">Derivatives & Spot</div>
                    </button>
                    
                    <button class="exchange-btn p-4 bg-zinc-900 border-2 border-zinc-800 rounded-lg hover:border-crimson-600/50 hover:bg-zinc-900/80 transition-all text-center group" data-exchange="binance">
                      <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">ðŸŸ </div>
                      <div class="text-[11px] text-white font-bold">Binance</div>
                      <div class="text-[9px] text-zinc-500">Derivatives & Spot</div>
                    </button>
                    
                    <button class="exchange-btn p-4 bg-zinc-900 border-2 border-zinc-800 rounded-lg hover:border-crimson-600/50 hover:bg-zinc-900/80 transition-all text-center group" data-exchange="hyperliquid">
                      <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">ðŸŸ¢</div>
                      <div class="text-[11px] text-white font-bold">Hyperliquid</div>
                      <div class="text-[9px] text-zinc-500">Perpetuals DEX</div>
                    </button>
                  </div>
                  
                  <!-- API Key Form (Hidden by default) -->
                  <div id="api-form" class="hidden border-t border-zinc-800 pt-5 mt-5">
                    <div class="flex items-center gap-2 mb-4">
                      <span id="selected-exchange-icon" class="text-2xl">ðŸ”µ</span>
                      <span id="selected-exchange-name" class="text-[13px] text-white font-bold">BloFin</span>
                    </div>
                    
                    <div class="space-y-4">
                      <div>
                        <label id="api-key-label" class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">API Key</label>
                        <input type="text" id="api-key" placeholder="Enter your API key" class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none placeholder-zinc-600 font-mono rounded">
                      </div>
                      
                      <div id="api-secret-field">
                        <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">API Secret</label>
                        <input type="password" id="api-secret" placeholder="Enter your API secret" class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none placeholder-zinc-600 font-mono rounded">
                      </div>
                      
                      <div id="passphrase-field" class="hidden">
                        <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">Passphrase (if required)</label>
                        <input type="password" id="api-passphrase" placeholder="Enter passphrase" class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none placeholder-zinc-600 font-mono rounded">
                      </div>
                      
                      <div class="flex items-center gap-2">
                        <input type="checkbox" id="read-only" checked class="w-4 h-4 bg-zinc-900 border-zinc-700 rounded focus:ring-crimson-600 text-crimson-600">
                        <label for="read-only" class="text-[10px] text-zinc-400">Read-only access (recommended for viewing positions)</label>
                      </div>
                      
                      <div class="flex gap-3 pt-2">
                        <button id="connect-btn" class="flex-1 bg-crimson-600 hover:bg-crimson-700 text-white text-[11px] font-bold py-2.5 rounded transition-colors">
                          <iconify-icon icon="solar:link-circle-bold" class="mr-1"></iconify-icon>
                          Connect Exchange
                        </button>
                        <button id="cancel-btn" class="px-4 bg-zinc-800 hover:bg-zinc-700 text-zinc-300 text-[11px] py-2.5 rounded transition-colors">
                          Cancel
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- ==================== ALERTS TAB ==================== -->
            <div id="tab-alerts" class="tab-content hidden">
              <div class="max-w-4xl">
                <div class="mb-6">
                  <h1 class="text-xl text-white font-bold mb-1">Alert Preferences</h1>
                  <p class="text-[11px] text-zinc-500">Configure how and when you receive alerts from BASTION.</p>
                </div>
                
                <div class="space-y-4">
                  <!-- Notification Channels -->
                  <div class="text-[11px] text-zinc-400 uppercase tracking-wider mb-3">Notification Channels</div>
                  
                  <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-4">
                    <div class="flex justify-between items-center">
                      <div>
                        <div class="text-[12px] text-white font-bold">Push Notifications</div>
                        <div class="text-[10px] text-zinc-500">Receive alerts via browser notifications</div>
                      </div>
                      <button class="toggle-btn w-12 h-6 rounded-full p-1 transition-all toggle-on" data-setting="push">
                        <div class="w-4 h-4 bg-white rounded-full ml-auto transition-all"></div>
                      </button>
                    </div>
                  </div>
                  
                  <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-4">
                    <div class="flex justify-between items-center">
                      <div>
                        <div class="text-[12px] text-white font-bold flex items-center gap-2">
                          <iconify-icon icon="logos:telegram" class="text-lg"></iconify-icon>
                          Telegram Alerts
                        </div>
                        <div class="text-[10px] text-zinc-500">Receive alerts via Telegram bot</div>
                      </div>
                      <button class="px-3 py-1.5 bg-[#229ED9] hover:bg-[#1a8dc2] text-white text-[10px] rounded transition-colors flex items-center gap-1" id="telegram-connect">
                        <iconify-icon icon="solar:link-bold"></iconify-icon>
                        Connect Telegram
                      </button>
                    </div>
                  </div>
                  
                  <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-4">
                    <div class="flex justify-between items-center">
                      <div>
                        <div class="text-[12px] text-white font-bold flex items-center gap-2">
                          <iconify-icon icon="logos:discord-icon" class="text-lg"></iconify-icon>
                          Discord Alerts
                        </div>
                        <div class="text-[10px] text-zinc-500">Receive alerts in your Discord server</div>
                      </div>
                      <button class="px-3 py-1.5 bg-[#5865F2] hover:bg-[#4752c4] text-white text-[10px] rounded transition-colors flex items-center gap-1">
                        <iconify-icon icon="solar:link-bold"></iconify-icon>
                        Connect Discord
                      </button>
                    </div>
                  </div>
                  
                  <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-4">
                    <div class="flex justify-between items-center">
                      <div>
                        <div class="text-[12px] text-white font-bold">Sound Alerts</div>
                        <div class="text-[10px] text-zinc-500">Play sound for important alerts</div>
                      </div>
                      <button class="toggle-btn w-12 h-6 rounded-full p-1 transition-all toggle-off" data-setting="sound">
                        <div class="w-4 h-4 bg-zinc-500 rounded-full transition-all"></div>
                      </button>
                    </div>
                  </div>
                  
                  <!-- Alert Types -->
                  <div class="text-[11px] text-zinc-400 uppercase tracking-wider mt-6 mb-3">Alert Types</div>
                  
                  <div class="grid grid-cols-2 gap-3">
                    <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-3 flex items-center gap-3">
                      <input type="checkbox" checked class="alert-checkbox w-4 h-4 bg-zinc-900 border-zinc-700 rounded text-crimson-600 focus:ring-crimson-600">
                      <div>
                        <div class="text-[11px] text-white">Whale Movements</div>
                        <div class="text-[9px] text-zinc-500">Large transactions > $10M</div>
                      </div>
                    </div>
                    <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-3 flex items-center gap-3">
                      <input type="checkbox" checked class="alert-checkbox w-4 h-4 bg-zinc-900 border-zinc-700 rounded text-crimson-600 focus:ring-crimson-600">
                      <div>
                        <div class="text-[11px] text-white">Price Targets</div>
                        <div class="text-[9px] text-zinc-500">Custom price alerts</div>
                      </div>
                    </div>
                    <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-3 flex items-center gap-3">
                      <input type="checkbox" checked class="alert-checkbox w-4 h-4 bg-zinc-900 border-zinc-700 rounded text-crimson-600 focus:ring-crimson-600">
                      <div>
                        <div class="text-[11px] text-white">Funding Rate Spikes</div>
                        <div class="text-[9px] text-zinc-500">Extreme funding rates</div>
                      </div>
                    </div>
                    <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-3 flex items-center gap-3">
                      <input type="checkbox" checked class="alert-checkbox w-4 h-4 bg-zinc-900 border-zinc-700 rounded text-crimson-600 focus:ring-crimson-600">
                      <div>
                        <div class="text-[11px] text-white">Liquidation Clusters</div>
                        <div class="text-[9px] text-zinc-500">Large liquidation events</div>
                      </div>
                    </div>
                    <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-3 flex items-center gap-3">
                      <input type="checkbox" class="alert-checkbox w-4 h-4 bg-zinc-900 border-zinc-700 rounded text-crimson-600 focus:ring-crimson-600">
                      <div>
                        <div class="text-[11px] text-white">IROS AI Signals</div>
                        <div class="text-[9px] text-zinc-500">AI-generated trade signals</div>
                      </div>
                    </div>
                    <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-3 flex items-center gap-3">
                      <input type="checkbox" class="alert-checkbox w-4 h-4 bg-zinc-900 border-zinc-700 rounded text-crimson-600 focus:ring-crimson-600">
                      <div>
                        <div class="text-[11px] text-white">Position Alerts</div>
                        <div class="text-[9px] text-zinc-500">Stop loss / take profit hit</div>
                      </div>
                    </div>
                    <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-3 flex items-center gap-3">
                      <input type="checkbox" checked class="alert-checkbox w-4 h-4 bg-zinc-900 border-zinc-700 rounded text-crimson-600 focus:ring-crimson-600">
                      <div>
                        <div class="text-[11px] text-white">Open Interest Spikes</div>
                        <div class="text-[9px] text-zinc-500">> 5% OI change in 1 hour</div>
                      </div>
                    </div>
                    <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-3 flex items-center gap-3">
                      <input type="checkbox" class="alert-checkbox w-4 h-4 bg-zinc-900 border-zinc-700 rounded text-crimson-600 focus:ring-crimson-600">
                      <div>
                        <div class="text-[11px] text-white">New Research Reports</div>
                        <div class="text-[9px] text-zinc-500">MCF Labs publications</div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Save Button -->
                  <div class="pt-4">
                    <button class="bg-crimson-600 hover:bg-crimson-700 text-white text-[11px] font-bold px-6 py-2.5 rounded transition-colors">
                      Save Alert Preferences
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- ==================== RISK SETTINGS TAB ==================== -->
            <div id="tab-risk" class="tab-content hidden">
              <div class="max-w-4xl">
                <div class="mb-6">
                  <h1 class="text-xl text-white font-bold mb-1">Risk Settings</h1>
                  <p class="text-[11px] text-zinc-500">Configure your risk management parameters. IROS will factor these into recommendations.</p>
                </div>
                
                <!-- Risk Overview -->
                <div class="grid grid-cols-3 gap-4 mb-6">
                  <div class="bg-gradient-to-br from-green-900/30 to-green-950/20 border border-green-800/50 rounded-lg p-4">
                    <div class="text-[10px] text-green-400 uppercase tracking-wider mb-1">Risk Score</div>
                    <div class="text-2xl text-white font-bold">MODERATE</div>
                    <div class="text-[10px] text-green-300/70">Balanced approach</div>
                  </div>
                  <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-4">
                    <div class="text-[10px] text-zinc-500 uppercase tracking-wider mb-1">Max Portfolio Risk</div>
                    <div class="text-2xl text-white font-bold">15%</div>
                    <div class="text-[10px] text-zinc-500">of total capital</div>
                  </div>
                  <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-4">
                    <div class="text-[10px] text-zinc-500 uppercase tracking-wider mb-1">Max Single Trade</div>
                    <div class="text-2xl text-white font-bold">5%</div>
                    <div class="text-[10px] text-zinc-500">per position</div>
                  </div>
                </div>
                
                <!-- Position Limits -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Position Limits</div>
                  
                  <div class="space-y-5">
                    <div>
                      <div class="flex justify-between mb-2">
                        <label class="text-[11px] text-zinc-400">Maximum Leverage</label>
                        <span class="text-[11px] text-white font-mono" id="leverage-value">20x</span>
                      </div>
                      <input type="range" min="1" max="100" value="20" class="w-full h-2 bg-zinc-800 rounded-lg appearance-none cursor-pointer slider-thumb" id="max-leverage">
                      <div class="flex justify-between text-[9px] text-zinc-600 mt-1">
                        <span>1x</span>
                        <span>25x</span>
                        <span>50x</span>
                        <span>100x</span>
                      </div>
                    </div>
                    
                    <div>
                      <div class="flex justify-between mb-2">
                        <label class="text-[11px] text-zinc-400">Max Position Size (% of Portfolio)</label>
                        <span class="text-[11px] text-white font-mono" id="position-size-value">25%</span>
                      </div>
                      <input type="range" min="5" max="100" value="25" class="w-full h-2 bg-zinc-800 rounded-lg appearance-none cursor-pointer slider-thumb" id="max-position">
                      <div class="flex justify-between text-[9px] text-zinc-600 mt-1">
                        <span>5%</span>
                        <span>25%</span>
                        <span>50%</span>
                        <span>100%</span>
                      </div>
                    </div>
                    
                    <div>
                      <div class="flex justify-between mb-2">
                        <label class="text-[11px] text-zinc-400">Max Open Positions</label>
                        <span class="text-[11px] text-white font-mono" id="open-positions-value">5</span>
                      </div>
                      <input type="range" min="1" max="20" value="5" class="w-full h-2 bg-zinc-800 rounded-lg appearance-none cursor-pointer slider-thumb" id="max-open-positions">
                      <div class="flex justify-between text-[9px] text-zinc-600 mt-1">
                        <span>1</span>
                        <span>5</span>
                        <span>10</span>
                        <span>20</span>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Drawdown Protection -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Drawdown Protection</div>
                  
                  <div class="space-y-4">
                    <div>
                      <div class="flex justify-between mb-2">
                        <label class="text-[11px] text-zinc-400">Daily Drawdown Limit</label>
                        <span class="text-[11px] text-white font-mono" id="daily-dd-value">5%</span>
                      </div>
                      <input type="range" min="1" max="20" value="5" class="w-full h-2 bg-zinc-800 rounded-lg appearance-none cursor-pointer slider-thumb" id="daily-drawdown">
                    </div>
                    
                    <div>
                      <div class="flex justify-between mb-2">
                        <label class="text-[11px] text-zinc-400">Weekly Drawdown Limit</label>
                        <span class="text-[11px] text-white font-mono" id="weekly-dd-value">10%</span>
                      </div>
                      <input type="range" min="5" max="50" value="10" class="w-full h-2 bg-zinc-800 rounded-lg appearance-none cursor-pointer slider-thumb" id="weekly-drawdown">
                    </div>
                    
                    <div class="flex items-center justify-between pt-2 border-t border-zinc-800">
                      <div>
                        <div class="text-[11px] text-white">Auto-pause trading on limit hit</div>
                        <div class="text-[9px] text-zinc-500">Prevents new positions when drawdown exceeded</div>
                      </div>
                      <button class="toggle-btn w-12 h-6 rounded-full p-1 transition-all toggle-on" data-setting="autopause">
                        <div class="w-4 h-4 bg-white rounded-full ml-auto transition-all"></div>
                      </button>
                    </div>
                  </div>
                </div>
                
                <!-- Risk Presets -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Risk Presets</div>
                  <div class="grid grid-cols-3 gap-3">
                    <button class="risk-preset p-4 bg-zinc-900 border-2 border-zinc-700 rounded-lg hover:border-green-600/50 transition-all text-center" data-preset="conservative">
                      <iconify-icon icon="solar:shield-check-bold" class="text-2xl text-green-500 mb-2"></iconify-icon>
                      <div class="text-[11px] text-white font-bold">Conservative</div>
                      <div class="text-[9px] text-zinc-500">5x max, 10% size</div>
                    </button>
                    <button class="risk-preset p-4 bg-zinc-900 border-2 border-crimson-600/50 rounded-lg transition-all text-center" data-preset="moderate">
                      <iconify-icon icon="solar:chart-2-bold" class="text-2xl text-amber-500 mb-2"></iconify-icon>
                      <div class="text-[11px] text-white font-bold">Moderate</div>
                      <div class="text-[9px] text-zinc-500">20x max, 25% size</div>
                    </button>
                    <button class="risk-preset p-4 bg-zinc-900 border-2 border-zinc-700 rounded-lg hover:border-crimson-600/50 transition-all text-center" data-preset="aggressive">
                      <iconify-icon icon="solar:fire-bold" class="text-2xl text-crimson-500 mb-2"></iconify-icon>
                      <div class="text-[11px] text-white font-bold">Aggressive</div>
                      <div class="text-[9px] text-zinc-500">50x max, 50% size</div>
                    </button>
                  </div>
                </div>
                
                <!-- Save Button -->
                <div class="flex gap-3">
                  <button class="bg-crimson-600 hover:bg-crimson-700 text-white text-[11px] font-bold px-6 py-2.5 rounded transition-colors" onclick="saveRiskSettings()">
                    Save Risk Settings
                  </button>
                  <button class="bg-zinc-800 hover:bg-zinc-700 text-white text-[11px] px-4 py-2.5 rounded transition-colors">
                    Reset to Defaults
                  </button>
                </div>
              </div>
            </div>
            
            <!-- ==================== APPEARANCE TAB ==================== -->
            <div id="tab-appearance" class="tab-content hidden">
              <div class="max-w-4xl">
                <div class="mb-6">
                  <h1 class="text-xl text-white font-bold mb-1">Appearance</h1>
                  <p class="text-[11px] text-zinc-500">Customize the look and feel of your BASTION terminal.</p>
                </div>
                
                <!-- Theme Selection -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Background Theme</div>
                  <div class="grid grid-cols-3 gap-3">
                    <button class="theme-btn p-3 bg-[#0a0a0a] border-2 border-crimson-600 rounded-lg text-center transition-all hover:scale-[1.02]" data-theme="crimson">
                      <div class="w-full h-10 rounded mb-2" style="background: radial-gradient(ellipse at top, rgba(220,38,38,0.2) 0%, transparent 60%), #0a0a0a;"></div>
                      <div class="text-[10px] text-white">Crimson Dark</div>
                      <div class="text-[8px] text-crimson-400 active-label">Active</div>
                    </button>
                    <button class="theme-btn p-3 bg-[#050510] border-2 border-zinc-700 rounded-lg text-center transition-all hover:scale-[1.02] hover:border-blue-500/50" data-theme="midnight">
                      <div class="w-full h-10 rounded mb-2" style="background: radial-gradient(ellipse at top, rgba(59,130,246,0.2) 0%, transparent 60%), #050510;"></div>
                      <div class="text-[10px] text-white">Midnight Blue</div>
                    </button>
                    <button class="theme-btn p-3 bg-[#030a03] border-2 border-zinc-700 rounded-lg text-center transition-all hover:scale-[1.02] hover:border-green-500/50" data-theme="matrix">
                      <div class="w-full h-10 rounded mb-2" style="background: radial-gradient(ellipse at top, rgba(34,197,94,0.2) 0%, transparent 60%), #030a03;"></div>
                      <div class="text-[10px] text-white">Matrix</div>
                    </button>
                    <button class="theme-btn p-3 bg-[#0a0a0a] border-2 border-zinc-700 rounded-lg text-center transition-all hover:scale-[1.02] hover:border-zinc-500/50" data-theme="stealth">
                      <div class="w-full h-10 rounded mb-2" style="background: linear-gradient(180deg, #0f0f0f 0%, #0a0a0a 50%, #080808 100%);"></div>
                      <div class="text-[10px] text-white">Stealth</div>
                    </button>
                    <button class="theme-btn p-3 bg-[#000000] border-2 border-zinc-700 rounded-lg text-center transition-all hover:scale-[1.02] hover:border-zinc-500/50" data-theme="abyss">
                      <div class="w-full h-10 rounded mb-2" style="background: radial-gradient(ellipse at center, #0a0a0a 0%, #000000 70%);"></div>
                      <div class="text-[10px] text-white">Abyss</div>
                    </button>
                    <button class="theme-btn p-3 bg-[#0c0c0c] border-2 border-zinc-700 rounded-lg text-center transition-all hover:scale-[1.02] hover:border-green-500/30" data-theme="terminal">
                      <div class="w-full h-10 rounded mb-2" style="background: radial-gradient(ellipse at top, rgba(0,255,0,0.1) 0%, transparent 60%), #0c0c0c;"></div>
                      <div class="text-[10px] text-white">Terminal</div>
                    </button>
                  </div>
                  <div class="text-[9px] text-zinc-600 mt-3">Changes the page background gradient only</div>
                </div>
                
                <!-- Chart Settings -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Chart Settings</div>
                  
                  <div class="space-y-4">
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-2 block">Default Chart Type</label>
                      <div class="flex gap-2">
                        <button class="chart-type-btn px-4 py-2 bg-crimson-600/20 border border-crimson-600/50 text-crimson-400 text-[10px] rounded" data-type="candles">Candlestick</button>
                        <button class="chart-type-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700" data-type="line">Line</button>
                        <button class="chart-type-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700" data-type="heikin">Heikin-Ashi</button>
                        <button class="chart-type-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700" data-type="bars">Bars</button>
                      </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                      <div>
                        <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-2 block">Up Candle Color</label>
                        <div class="flex items-center gap-2">
                          <input type="color" value="#22c55e" class="w-10 h-10 rounded border border-zinc-700 bg-transparent cursor-pointer" id="up-color">
                          <span class="text-[10px] text-zinc-400 font-mono">#22c55e</span>
                        </div>
                      </div>
                      <div>
                        <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-2 block">Down Candle Color</label>
                        <div class="flex items-center gap-2">
                          <input type="color" value="#ef4444" class="w-10 h-10 rounded border border-zinc-700 bg-transparent cursor-pointer" id="down-color">
                          <span class="text-[10px] text-zinc-400 font-mono">#ef4444</span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="flex items-center justify-between pt-2 border-t border-zinc-800">
                      <div>
                        <div class="text-[11px] text-white">Show Volume Bars</div>
                        <div class="text-[9px] text-zinc-500">Display volume below price chart</div>
                      </div>
                      <button class="toggle-btn w-12 h-6 rounded-full p-1 transition-all toggle-on" data-setting="volume">
                        <div class="w-4 h-4 bg-white rounded-full ml-auto transition-all"></div>
                      </button>
                    </div>
                    
                    <div class="flex items-center justify-between">
                      <div>
                        <div class="text-[11px] text-white">Show Grid Lines</div>
                        <div class="text-[9px] text-zinc-500">Display background grid</div>
                      </div>
                      <button class="toggle-btn w-12 h-6 rounded-full p-1 transition-all toggle-on" data-setting="grid">
                        <div class="w-4 h-4 bg-white rounded-full ml-auto transition-all"></div>
                      </button>
                    </div>
                  </div>
                </div>
                
                <!-- Display Options -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Display Options</div>
                  
                  <div class="space-y-4">
                    <div class="flex items-center justify-between">
                      <div>
                        <div class="text-[11px] text-white">Compact Mode</div>
                        <div class="text-[9px] text-zinc-500">Reduce padding for more data density</div>
                      </div>
                      <button class="toggle-btn w-12 h-6 rounded-full p-1 transition-all toggle-off" data-setting="compact">
                        <div class="w-4 h-4 bg-zinc-500 rounded-full transition-all"></div>
                      </button>
                    </div>
                    
                    <div class="flex items-center justify-between">
                      <div>
                        <div class="text-[11px] text-white">Scanlines Effect</div>
                        <div class="text-[9px] text-zinc-500">CRT monitor aesthetic overlay</div>
                      </div>
                      <button class="toggle-btn w-12 h-6 rounded-full p-1 transition-all toggle-on" data-setting="scanlines">
                        <div class="w-4 h-4 bg-white rounded-full ml-auto transition-all"></div>
                      </button>
                    </div>
                    
                    <div class="flex items-center justify-between">
                      <div>
                        <div class="text-[11px] text-white">Animations</div>
                        <div class="text-[9px] text-zinc-500">Enable UI animations and transitions</div>
                      </div>
                      <button class="toggle-btn w-12 h-6 rounded-full p-1 transition-all toggle-on" data-setting="animations">
                        <div class="w-4 h-4 bg-white rounded-full ml-auto transition-all"></div>
                      </button>
                    </div>
                    
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-2 block">Font Size</label>
                      <div class="flex gap-2">
                        <button class="font-size-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700">Small</button>
                        <button class="font-size-btn px-4 py-2 bg-crimson-600/20 border border-crimson-600/50 text-crimson-400 text-[10px] rounded">Medium</button>
                        <button class="font-size-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700">Large</button>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Save Button -->
                <button class="bg-crimson-600 hover:bg-crimson-700 text-white text-[11px] font-bold px-6 py-2.5 rounded transition-colors" onclick="saveAppearanceSettings()">
                  Save Appearance Settings
                </button>
              </div>
            </div>
            
            <!-- ==================== SUBSCRIPTION TAB ==================== -->
            <div id="tab-subscription" class="tab-content hidden">
              <div class="max-w-5xl">
                <div class="mb-6">
                  <h1 class="text-xl text-white font-bold mb-1">Subscription</h1>
                  <p class="text-[11px] text-zinc-500">Manage your BASTION subscription and billing.</p>
                </div>
                
                <!-- Current Plan -->
                <div class="bg-gradient-to-br from-crimson-900/30 to-crimson-950/20 border border-crimson-800/50 rounded-lg p-5 mb-6">
                  <div class="flex justify-between items-start">
                    <div>
                      <div class="flex items-center gap-2 mb-2">
                        <iconify-icon icon="solar:crown-bold" class="text-2xl text-crimson-400"></iconify-icon>
                        <span class="text-lg text-white font-bold">PRO TIER</span>
                      </div>
                      <div class="text-[11px] text-zinc-400 mb-4">Your subscription renews on March 5, 2026</div>
                      <div class="flex gap-3">
                        <div class="bg-black/30 rounded px-3 py-2">
                          <div class="text-[9px] text-zinc-500 uppercase">API Calls</div>
                          <div class="text-[14px] text-white font-bold">8,000/mo</div>
                        </div>
                        <div class="bg-black/30 rounded px-3 py-2">
                          <div class="text-[9px] text-zinc-500 uppercase">IROS Queries</div>
                          <div class="text-[14px] text-white font-bold">Unlimited</div>
                        </div>
                        <div class="bg-black/30 rounded px-3 py-2">
                          <div class="text-[9px] text-zinc-500 uppercase">Exchanges</div>
                          <div class="text-[14px] text-white font-bold">6 max</div>
                        </div>
                      </div>
                    </div>
                    <div class="text-right">
                      <div class="text-3xl text-white font-bold">$49</div>
                      <div class="text-[11px] text-zinc-500">per month</div>
                    </div>
                  </div>
                </div>
                
                <!-- All Plans -->
                <div class="text-[11px] text-zinc-400 uppercase tracking-wider mb-4">Available Plans</div>
                
                <div class="grid grid-cols-3 gap-4 mb-6">
                  <!-- Free Plan -->
                  <div class="plan-card bg-[#0D0D0D] border-2 border-zinc-800 rounded-lg p-5 transition-all">
                    <div class="text-[10px] text-zinc-500 uppercase tracking-wider mb-1">Starter</div>
                    <div class="text-2xl text-white font-bold mb-1">FREE</div>
                    <div class="text-[10px] text-zinc-500 mb-4">Forever</div>
                    
                    <ul class="space-y-2 mb-6">
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        500 API calls/month
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        1 Exchange connection
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        Basic market data
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:close-circle-bold" class="text-zinc-600"></iconify-icon>
                        <span class="text-zinc-600">IROS AI Assistant</span>
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:close-circle-bold" class="text-zinc-600"></iconify-icon>
                        <span class="text-zinc-600">Research Terminal</span>
                      </li>
                    </ul>
                    
                    <button class="w-full py-2 bg-zinc-800 text-zinc-400 text-[10px] rounded border border-zinc-700">
                      Current limitations
                    </button>
                  </div>
                  
                  <!-- Pro Plan -->
                  <div class="plan-card active bg-[#0D0D0D] border-2 border-crimson-600 rounded-lg p-5 transition-all relative overflow-hidden">
                    <div class="absolute top-3 right-3 bg-crimson-600 text-white text-[8px] px-2 py-0.5 rounded-full uppercase tracking-wider">Current</div>
                    
                    <div class="text-[10px] text-crimson-400 uppercase tracking-wider mb-1">Pro</div>
                    <div class="text-2xl text-white font-bold mb-1">$49<span class="text-[14px] text-zinc-500">/mo</span></div>
                    <div class="text-[10px] text-zinc-500 mb-4">Billed monthly</div>
                    
                    <ul class="space-y-2 mb-6">
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        8,000 API calls/month
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        6 Exchange connections
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        Full market data
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        Unlimited IROS queries
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        Research Terminal access
                      </li>
                    </ul>
                    
                    <button class="w-full py-2 bg-crimson-600/20 text-crimson-400 text-[10px] rounded border border-crimson-600/50">
                      Your current plan
                    </button>
                  </div>
                  
                  <!-- Enterprise Plan -->
                  <div class="plan-card bg-[#0D0D0D] border-2 border-zinc-800 rounded-lg p-5 transition-all hover:border-amber-600/50">
                    <div class="text-[10px] text-amber-400 uppercase tracking-wider mb-1">Enterprise</div>
                    <div class="text-2xl text-white font-bold mb-1">$199<span class="text-[14px] text-zinc-500">/mo</span></div>
                    <div class="text-[10px] text-zinc-500 mb-4">Billed annually</div>
                    
                    <ul class="space-y-2 mb-6">
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        Unlimited API calls
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        Unlimited exchanges
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        Real-time data streams
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        Custom IROS training
                      </li>
                      <li class="text-[10px] text-zinc-400 flex items-center gap-2">
                        <iconify-icon icon="solar:check-circle-bold" class="text-green-500"></iconify-icon>
                        Priority support
                      </li>
                    </ul>
                    
                    <button class="w-full py-2 bg-amber-600 hover:bg-amber-700 text-white text-[10px] font-bold rounded transition-colors">
                      Upgrade to Enterprise
                    </button>
                  </div>
                </div>
                
                <!-- Billing History -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5">
                  <div class="flex justify-between items-center mb-4">
                    <div class="text-[13px] text-white font-bold">Billing History</div>
                    <button class="text-[10px] text-crimson-400 hover:text-crimson-300">Download All</button>
                  </div>
                  
                  <div class="space-y-2">
                    <div class="flex justify-between items-center p-3 bg-zinc-900/50 rounded">
                      <div class="flex items-center gap-3">
                        <iconify-icon icon="solar:document-text-bold" class="text-zinc-500"></iconify-icon>
                        <div>
                          <div class="text-[11px] text-white">Pro Plan - February 2026</div>
                          <div class="text-[9px] text-zinc-500">Feb 5, 2026</div>
                        </div>
                      </div>
                      <div class="flex items-center gap-4">
                        <span class="text-[11px] text-white font-mono">$49.00</span>
                        <span class="text-[9px] text-green-400 bg-green-900/30 px-2 py-0.5 rounded">Paid</span>
                        <button class="text-[9px] text-zinc-400 hover:text-white">Invoice</button>
                      </div>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-zinc-900/50 rounded">
                      <div class="flex items-center gap-3">
                        <iconify-icon icon="solar:document-text-bold" class="text-zinc-500"></iconify-icon>
                        <div>
                          <div class="text-[11px] text-white">Pro Plan - January 2026</div>
                          <div class="text-[9px] text-zinc-500">Jan 5, 2026</div>
                        </div>
                      </div>
                      <div class="flex items-center gap-4">
                        <span class="text-[11px] text-white font-mono">$49.00</span>
                        <span class="text-[9px] text-green-400 bg-green-900/30 px-2 py-0.5 rounded">Paid</span>
                        <button class="text-[9px] text-zinc-400 hover:text-white">Invoice</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- ==================== PROFILE TAB ==================== -->
            <div id="tab-profile" class="tab-content hidden">
              <div class="max-w-2xl">
                <div class="mb-6">
                  <h1 class="text-xl text-white font-bold mb-1">Profile</h1>
                  <p class="text-[11px] text-zinc-500">Manage your personal information.</p>
                </div>
                
                <!-- Avatar Section -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Avatar</div>
                  <div class="flex items-center gap-4">
                    <div class="w-20 h-20 rounded-full bg-gradient-to-br from-crimson-600 to-crimson-900 flex items-center justify-center text-white font-bold text-2xl" id="profile-avatar">
                      T
                    </div>
                    <div>
                      <button class="px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white text-[10px] rounded transition-colors mb-2">
                        Upload Photo
                      </button>
                      <div class="text-[9px] text-zinc-500">JPG, PNG or GIF. Max 2MB.</div>
                    </div>
                  </div>
                </div>
                
                <!-- Profile Info -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Basic Information</div>
                  
                  <div class="space-y-4">
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">Display Name</label>
                      <input type="text" value="Trader" id="profile-name" class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none rounded">
                    </div>
                    
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">Email Address</label>
                      <input type="email" value="trader@example.com" id="profile-email" class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none rounded">
                      <div class="text-[9px] text-green-400 mt-1 flex items-center gap-1">
                        <iconify-icon icon="solar:check-circle-bold"></iconify-icon>
                        Email verified
                      </div>
                    </div>
                    
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">Timezone</label>
                      <select class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none rounded">
                        <option value="UTC">UTC (Coordinated Universal Time)</option>
                        <option value="EST">EST (Eastern Standard Time)</option>
                        <option value="PST">PST (Pacific Standard Time)</option>
                        <option value="GMT">GMT (Greenwich Mean Time)</option>
                        <option value="CET">CET (Central European Time)</option>
                        <option value="JST">JST (Japan Standard Time)</option>
                      </select>
                    </div>
                    
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">Preferred Currency</label>
                      <select class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none rounded">
                        <option value="USD">USD ($)</option>
                        <option value="EUR">EUR (â‚¬)</option>
                        <option value="GBP">GBP (Â£)</option>
                        <option value="BTC">BTC (â‚¿)</option>
                      </select>
                    </div>
                  </div>
                </div>
                
                <!-- Trading Profile -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Trading Profile</div>
                  
                  <div class="space-y-4">
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-2 block">Trading Experience</label>
                      <div class="flex gap-2">
                        <button class="exp-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700">Beginner</button>
                        <button class="exp-btn px-4 py-2 bg-crimson-600/20 border border-crimson-600/50 text-crimson-400 text-[10px] rounded">Intermediate</button>
                        <button class="exp-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700">Advanced</button>
                        <button class="exp-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700">Professional</button>
                      </div>
                    </div>
                    
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-2 block">Primary Trading Style</label>
                      <div class="grid grid-cols-2 gap-2">
                        <button class="style-btn px-4 py-2 bg-crimson-600/20 border border-crimson-600/50 text-crimson-400 text-[10px] rounded text-left flex items-center gap-2">
                          <iconify-icon icon="solar:bolt-bold"></iconify-icon>
                          Scalping
                        </button>
                        <button class="style-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700 text-left flex items-center gap-2">
                          <iconify-icon icon="solar:clock-circle-bold"></iconify-icon>
                          Day Trading
                        </button>
                        <button class="style-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700 text-left flex items-center gap-2">
                          <iconify-icon icon="solar:calendar-bold"></iconify-icon>
                          Swing Trading
                        </button>
                        <button class="style-btn px-4 py-2 bg-zinc-800 border border-zinc-700 text-zinc-400 text-[10px] rounded hover:bg-zinc-700 text-left flex items-center gap-2">
                          <iconify-icon icon="solar:hourglass-bold"></iconify-icon>
                          Position Trading
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Save Button -->
                <button class="bg-crimson-600 hover:bg-crimson-700 text-white text-[11px] font-bold px-6 py-2.5 rounded transition-colors" onclick="saveProfile()">
                  Save Profile
                </button>
              </div>
            </div>
            
            <!-- ==================== SECURITY TAB ==================== -->
            <div id="tab-security" class="tab-content hidden">
              <div class="max-w-2xl">
                <div class="mb-6">
                  <h1 class="text-xl text-white font-bold mb-1">Security</h1>
                  <p class="text-[11px] text-zinc-500">Manage your account security settings.</p>
                </div>
                
                <!-- 2FA Section -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="flex justify-between items-start mb-4">
                    <div>
                      <div class="text-[13px] text-white font-bold flex items-center gap-2">
                        <iconify-icon icon="solar:shield-keyhole-bold" class="text-green-500"></iconify-icon>
                        Two-Factor Authentication
                      </div>
                      <div class="text-[10px] text-zinc-500 mt-1">Add an extra layer of security to your account</div>
                    </div>
                    <span class="text-[9px] text-green-400 bg-green-900/30 px-2 py-1 rounded">Enabled</span>
                  </div>
                  
                  <div class="bg-green-900/20 border border-green-800/50 rounded-lg p-3 mb-4">
                    <div class="flex items-center gap-2 text-[10px] text-green-400">
                      <iconify-icon icon="solar:check-circle-bold"></iconify-icon>
                      Your account is protected with authenticator app
                    </div>
                  </div>
                  
                  <div class="flex gap-2">
                    <button class="px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white text-[10px] rounded transition-colors">
                      Reconfigure 2FA
                    </button>
                    <button class="px-4 py-2 bg-crimson-900/30 hover:bg-crimson-900/50 text-crimson-400 text-[10px] rounded transition-colors">
                      Disable 2FA
                    </button>
                  </div>
                </div>
                
                <!-- Password -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="text-[13px] text-white font-bold mb-4">Change Password</div>
                  
                  <div class="space-y-4">
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">Current Password</label>
                      <input type="password" placeholder="Enter current password" class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none rounded">
                    </div>
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">New Password</label>
                      <input type="password" placeholder="Enter new password" class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none rounded">
                    </div>
                    <div>
                      <label class="text-[10px] text-zinc-400 uppercase tracking-wider mb-1 block">Confirm New Password</label>
                      <input type="password" placeholder="Confirm new password" class="w-full bg-zinc-900 border border-zinc-700 text-[11px] text-white px-3 py-2.5 focus:border-crimson-600 focus:outline-none rounded">
                    </div>
                    
                    <div class="text-[9px] text-zinc-500">
                      Password must be at least 12 characters with uppercase, lowercase, number, and special character.
                    </div>
                    
                    <button class="bg-crimson-600 hover:bg-crimson-700 text-white text-[11px] font-bold px-6 py-2.5 rounded transition-colors">
                      Update Password
                    </button>
                  </div>
                </div>
                
                <!-- Active Sessions -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="flex justify-between items-center mb-4">
                    <div class="text-[13px] text-white font-bold">Active Sessions</div>
                    <button class="text-[10px] text-crimson-400 hover:text-crimson-300">Sign out all devices</button>
                  </div>
                  
                  <div class="space-y-3">
                    <div class="flex justify-between items-center p-3 bg-green-900/10 border border-green-800/30 rounded">
                      <div class="flex items-center gap-3">
                        <iconify-icon icon="solar:monitor-bold" class="text-green-400 text-xl"></iconify-icon>
                        <div>
                          <div class="text-[11px] text-white flex items-center gap-2">
                            Windows - Chrome
                            <span class="text-[8px] text-green-400 bg-green-900/50 px-1.5 py-0.5 rounded">Current</span>
                          </div>
                          <div class="text-[9px] text-zinc-500">IP: 192.168.1.xxx â€¢ Active now</div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="flex justify-between items-center p-3 bg-zinc-900/50 rounded">
                      <div class="flex items-center gap-3">
                        <iconify-icon icon="solar:smartphone-bold" class="text-zinc-400 text-xl"></iconify-icon>
                        <div>
                          <div class="text-[11px] text-white">iPhone - Safari</div>
                          <div class="text-[9px] text-zinc-500">IP: 192.168.1.xxx â€¢ Last active 2 hours ago</div>
                        </div>
                      </div>
                      <button class="text-[9px] text-crimson-400 hover:text-crimson-300">Revoke</button>
                    </div>
                  </div>
                </div>
                
                <!-- API Keys -->
                <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-5 mb-4">
                  <div class="flex justify-between items-center mb-4">
                    <div>
                      <div class="text-[13px] text-white font-bold">API Keys</div>
                      <div class="text-[10px] text-zinc-500">Manage programmatic access to your account</div>
                    </div>
                    <button class="px-3 py-1.5 bg-crimson-600 hover:bg-crimson-700 text-white text-[10px] rounded transition-colors">
                      Generate New Key
                    </button>
                  </div>
                  
                  <div class="bg-zinc-900/50 border border-zinc-800 rounded p-3 text-center">
                    <iconify-icon icon="solar:key-bold" class="text-2xl text-zinc-600 mb-1"></iconify-icon>
                    <div class="text-[10px] text-zinc-500">No API keys generated</div>
                  </div>
                </div>
                
                <!-- Danger Zone -->
                <div class="bg-crimson-950/20 border border-crimson-900/50 rounded-lg p-5">
                  <div class="text-[13px] text-crimson-400 font-bold mb-2">Danger Zone</div>
                  <div class="text-[10px] text-zinc-400 mb-4">Irreversible actions that affect your account</div>
                  
                  <div class="flex gap-3">
                    <button class="px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white text-[10px] rounded transition-colors">
                      Export All Data
                    </button>
                    <button class="px-4 py-2 bg-crimson-900/30 hover:bg-crimson-900/50 text-crimson-400 text-[10px] rounded transition-colors border border-crimson-800/50">
                      Delete Account
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
        </div>
      </div>
    </main>

    <script>
      const API_BASE = window.location.origin;
      
      // ==================== TIME ====================
      function updateTime() {
        const now = new Date();
        document.getElementById('current-time').textContent = now.toUTCString().slice(17, 25) + ' UTC';
      }
      setInterval(updateTime, 1000);
      updateTime();

      // ==================== EXCHANGE CONFIGS ====================
      const exchangeConfigs = {
        blofin: { name: 'BloFin', icon: 'ðŸ”µ', needsPassphrase: true, isWalletBased: false },
        bitunix: { name: 'Bitunix', icon: 'ðŸŸ£', needsPassphrase: false, isWalletBased: false },
        bybit: { name: 'Bybit', icon: 'ðŸŸ¡', needsPassphrase: false, isWalletBased: false },
        okx: { name: 'OKX', icon: 'âš«', needsPassphrase: true, isWalletBased: false },
        binance: { name: 'Binance', icon: 'ðŸŸ ', needsPassphrase: false, isWalletBased: false },
        hyperliquid: { name: 'Hyperliquid', icon: 'ðŸŸ¢', needsPassphrase: false, isWalletBased: true }
      };

      let selectedExchange = null;
      let connectedExchanges = [];

      // ==================== TAB NAVIGATION ====================
      document.querySelectorAll('[data-tab]').forEach(btn => {
        btn.addEventListener('click', () => {
          const tabId = btn.dataset.tab;
          
          // Update active button
          document.querySelectorAll('.sidebar-btn').forEach(b => {
            b.classList.remove('bg-crimson-600/20', 'text-crimson-400', 'border', 'border-crimson-600/30');
            b.classList.add('text-zinc-400');
          });
          btn.classList.add('bg-crimson-600/20', 'text-crimson-400', 'border', 'border-crimson-600/30');
          btn.classList.remove('text-zinc-400');
          
          // Show content
          document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
          const tabContent = document.getElementById(`tab-${tabId}`);
          if (tabContent) tabContent.classList.remove('hidden');
        });
      });

      // ==================== TOGGLE BUTTONS ====================
      document.querySelectorAll('.toggle-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const isOn = btn.classList.contains('toggle-on');
          const thumb = btn.querySelector('div');
          
          if (isOn) {
            btn.classList.remove('toggle-on');
            btn.classList.add('toggle-off');
            thumb.classList.remove('ml-auto', 'bg-white');
            thumb.classList.add('bg-zinc-500');
          } else {
            btn.classList.remove('toggle-off');
            btn.classList.add('toggle-on');
            thumb.classList.remove('bg-zinc-500');
            thumb.classList.add('ml-auto', 'bg-white');
          }
        });
      });

      // ==================== EXCHANGE SELECTION ====================
      document.querySelectorAll('.exchange-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          selectedExchange = btn.dataset.exchange;
          const config = exchangeConfigs[selectedExchange];
          
          document.querySelectorAll('.exchange-btn').forEach(b => {
            b.classList.remove('border-crimson-600', 'bg-crimson-900/20');
            b.classList.add('border-zinc-800');
          });
          btn.classList.add('border-crimson-600', 'bg-crimson-900/20');
          btn.classList.remove('border-zinc-800');
          
          document.getElementById('api-form').classList.remove('hidden');
          document.getElementById('selected-exchange-icon').textContent = config.icon;
          document.getElementById('selected-exchange-name').textContent = config.name;
          
          const apiKeyInput = document.getElementById('api-key');
          const apiSecretField = document.getElementById('api-secret-field');
          const passphraseField = document.getElementById('passphrase-field');
          
          const apiKeyLabel = document.getElementById('api-key-label');
          
          // Handle wallet-based exchanges (Hyperliquid)
          if (config.isWalletBased) {
            if (apiKeyInput) apiKeyInput.placeholder = 'Enter your wallet address (0x...)';
            if (apiKeyLabel) apiKeyLabel.textContent = 'WALLET ADDRESS';
            if (apiSecretField) apiSecretField.classList.add('hidden');
            if (passphraseField) passphraseField.classList.add('hidden');
          } else {
            if (apiKeyInput) apiKeyInput.placeholder = 'Enter your API key';
            if (apiKeyLabel) apiKeyLabel.textContent = 'API KEY';
            if (apiSecretField) apiSecretField.classList.remove('hidden');
            if (config.needsPassphrase) {
              passphraseField?.classList.remove('hidden');
            } else {
              passphraseField?.classList.add('hidden');
            }
          }
        });
      });

      document.getElementById('cancel-btn').addEventListener('click', () => {
        document.getElementById('api-form').classList.add('hidden');
        document.querySelectorAll('.exchange-btn').forEach(b => {
          b.classList.remove('border-crimson-600', 'bg-crimson-900/20');
          b.classList.add('border-zinc-800');
        });
        selectedExchange = null;
      });

      document.getElementById('connect-btn').addEventListener('click', async () => {
        const config = exchangeConfigs[selectedExchange];
        const apiKey = document.getElementById('api-key').value;
        const apiSecret = document.getElementById('api-secret').value;
        const passphrase = document.getElementById('api-passphrase').value;
        const readOnly = document.getElementById('read-only').checked;
        
        // Validation based on exchange type
        if (config.isWalletBased) {
          if (!apiKey || !apiKey.startsWith('0x')) {
            alert('Please enter a valid wallet address (0x...)');
            return;
          }
        } else {
          if (!apiKey || !apiSecret) {
            alert('Please enter both API key and secret');
            return;
          }
        }
        
        try {
          const res = await fetch(`${API_BASE}/api/exchange/connect`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              exchange: selectedExchange,
              api_key: apiKey,
              api_secret: config.isWalletBased ? apiKey : apiSecret, // For wallet-based, use address as both
              passphrase: passphrase || null,
              read_only: readOnly
            })
          });
          
          const data = await res.json();
          
          if (data.success) {
            showToast(`Connected to ${exchangeConfigs[selectedExchange].name}!`, 'success');
            addConnectedExchange(selectedExchange);
            document.getElementById('api-form').classList.add('hidden');
            clearForm();
          } else {
            showToast(`Failed: ${data.error || 'Unknown error'}`, 'error');
          }
        } catch (e) {
          console.error('Connection error:', e);
          addConnectedExchange(selectedExchange);
          document.getElementById('api-form').classList.add('hidden');
          clearForm();
        }
      });

      function clearForm() {
        document.getElementById('api-key').value = '';
        document.getElementById('api-secret').value = '';
        document.getElementById('api-passphrase').value = '';
      }

      function addConnectedExchange(exchange) {
        if (connectedExchanges.includes(exchange)) return;
        connectedExchanges.push(exchange);
        
        const config = exchangeConfigs[exchange];
        const container = document.getElementById('connected-exchanges');
        
        if (connectedExchanges.length === 1) {
          container.innerHTML = '';
        }
        
        const exchangeId = `exchange-${exchange}`;
        container.innerHTML += `
          <div id="${exchangeId}" class="bg-[#0D0D0D] border border-green-900/50 rounded-lg p-4">
            <div class="flex items-center justify-between mb-3">
              <div class="flex items-center gap-3">
                <span class="text-2xl">${config.icon}</span>
                <div>
                  <div class="text-[12px] text-white font-bold">${config.name}</div>
                  <div id="${exchangeId}-status" class="text-[9px] text-green-400 flex items-center gap-1">
                    <span class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span>
                    Connected â€¢ Read-only
                  </div>
                </div>
              </div>
              <div class="flex items-center gap-2">
                <button id="${exchangeId}-sync" class="px-3 py-1.5 bg-zinc-800 hover:bg-zinc-700 text-white text-[10px] rounded transition-colors" onclick="syncExchange('${exchange}')">
                  <iconify-icon icon="solar:refresh-linear" class="mr-1"></iconify-icon>Sync
                </button>
                <button class="px-3 py-1.5 bg-crimson-900/30 hover:bg-crimson-900/50 text-crimson-400 text-[10px] rounded transition-colors" onclick="disconnectExchange('${exchange}')">
                  <iconify-icon icon="solar:trash-bin-trash-linear" class="mr-1"></iconify-icon>Remove
                </button>
              </div>
            </div>
            <!-- Balance Display -->
            <div id="${exchangeId}-balance" class="grid grid-cols-4 gap-2 text-center">
              <div class="bg-zinc-900/50 rounded p-2">
                <div class="text-[9px] text-zinc-500">Equity</div>
                <div class="text-[11px] text-white font-mono" id="${exchangeId}-equity">--</div>
              </div>
              <div class="bg-zinc-900/50 rounded p-2">
                <div class="text-[9px] text-zinc-500">Available</div>
                <div class="text-[11px] text-white font-mono" id="${exchangeId}-available">--</div>
              </div>
              <div class="bg-zinc-900/50 rounded p-2">
                <div class="text-[9px] text-zinc-500">Margin Used</div>
                <div class="text-[11px] text-white font-mono" id="${exchangeId}-margin">--</div>
              </div>
              <div class="bg-zinc-900/50 rounded p-2">
                <div class="text-[9px] text-zinc-500">uPnL</div>
                <div class="text-[11px] font-mono" id="${exchangeId}-upnl">--</div>
              </div>
            </div>
            <!-- Positions Count -->
            <div class="mt-2 flex items-center justify-between text-[9px]">
              <span class="text-zinc-500">Open Positions: <span id="${exchangeId}-positions" class="text-white font-mono">--</span></span>
              <span id="${exchangeId}-last-sync" class="text-zinc-600">Never synced</span>
            </div>
          </div>
        `;
        
        // Auto sync on connect
        setTimeout(() => syncExchange(exchange), 500);
      }
      
      async function syncExchange(exchange) {
        const exchangeId = `exchange-${exchange}`;
        const syncBtn = document.getElementById(`${exchangeId}-sync`);
        const statusEl = document.getElementById(`${exchangeId}-status`);
        
        // Show loading state
        if (syncBtn) {
          syncBtn.innerHTML = '<iconify-icon icon="solar:refresh-linear" class="mr-1 animate-spin"></iconify-icon>Syncing...';
          syncBtn.disabled = true;
        }
        
        try {
          const response = await fetch(`${API_BASE}/api/exchange/${exchange}/sync`, { method: 'POST' });
          const data = await response.json();
          
          if (data.success) {
            // Update balance display
            const balance = data.balance || {};
            document.getElementById(`${exchangeId}-equity`).textContent = formatUSD(balance.total_equity);
            document.getElementById(`${exchangeId}-available`).textContent = formatUSD(balance.available_balance);
            document.getElementById(`${exchangeId}-margin`).textContent = formatUSD(balance.margin_used);
            
            const upnlEl = document.getElementById(`${exchangeId}-upnl`);
            const upnl = balance.unrealized_pnl || 0;
            upnlEl.textContent = (upnl >= 0 ? '+' : '') + formatUSD(upnl);
            upnlEl.className = `text-[11px] font-mono ${upnl >= 0 ? 'text-green-400' : 'text-red-400'}`;
            
            // Update positions count
            document.getElementById(`${exchangeId}-positions`).textContent = data.positions_count || 0;
            
            // Update last sync time
            document.getElementById(`${exchangeId}-last-sync`).textContent = `Synced ${new Date().toLocaleTimeString()}`;
            
            showToast(`${exchangeConfigs[exchange].name} synced! ${data.positions_count} positions`, 'success');
          } else {
            statusEl.innerHTML = `<span class="w-1.5 h-1.5 bg-yellow-500 rounded-full"></span> Sync failed - ${data.error || 'Unknown error'}`;
            showToast(`Sync failed: ${data.error}`, 'error');
          }
        } catch (err) {
          console.error('Sync error:', err);
          showToast('Sync failed - Network error', 'error');
        } finally {
          if (syncBtn) {
            syncBtn.innerHTML = '<iconify-icon icon="solar:refresh-linear" class="mr-1"></iconify-icon>Sync';
            syncBtn.disabled = false;
          }
        }
      }
      
      function formatUSD(amount) {
        if (amount === undefined || amount === null) return '--';
        return '$' + parseFloat(amount).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      }

      function disconnectExchange(exchange) {
        connectedExchanges = connectedExchanges.filter(e => e !== exchange);
        
        const container = document.getElementById('connected-exchanges');
        if (connectedExchanges.length === 0) {
          container.innerHTML = `
            <div class="bg-zinc-900/50 border border-zinc-800 rounded-lg p-4 text-center">
              <iconify-icon icon="solar:link-broken-linear" class="text-3xl text-zinc-600 mb-2"></iconify-icon>
              <div class="text-[11px] text-zinc-500">No exchanges connected yet</div>
              <div class="text-[10px] text-zinc-600">Add an exchange below to get started</div>
            </div>
          `;
        } else {
          container.innerHTML = '';
          connectedExchanges.forEach(e => addConnectedExchange(e));
        }
      }

      // ==================== RISK SETTINGS ====================
      const leverageSlider = document.getElementById('max-leverage');
      const positionSlider = document.getElementById('max-position');
      const openPositionsSlider = document.getElementById('max-open-positions');
      const dailyDDSlider = document.getElementById('daily-drawdown');
      const weeklyDDSlider = document.getElementById('weekly-drawdown');

      if (leverageSlider) {
        leverageSlider.addEventListener('input', (e) => {
          document.getElementById('leverage-value').textContent = e.target.value + 'x';
        });
      }
      if (positionSlider) {
        positionSlider.addEventListener('input', (e) => {
          document.getElementById('position-size-value').textContent = e.target.value + '%';
        });
      }
      if (openPositionsSlider) {
        openPositionsSlider.addEventListener('input', (e) => {
          document.getElementById('open-positions-value').textContent = e.target.value;
        });
      }
      if (dailyDDSlider) {
        dailyDDSlider.addEventListener('input', (e) => {
          document.getElementById('daily-dd-value').textContent = e.target.value + '%';
        });
      }
      if (weeklyDDSlider) {
        weeklyDDSlider.addEventListener('input', (e) => {
          document.getElementById('weekly-dd-value').textContent = e.target.value + '%';
        });
      }

      // Risk presets
      document.querySelectorAll('.risk-preset').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.risk-preset').forEach(b => {
            b.classList.remove('border-crimson-600/50');
            b.classList.add('border-zinc-700');
          });
          btn.classList.add('border-crimson-600/50');
          btn.classList.remove('border-zinc-700');
          
          const preset = btn.dataset.preset;
          if (preset === 'conservative') {
            leverageSlider.value = 5;
            positionSlider.value = 10;
            document.getElementById('leverage-value').textContent = '5x';
            document.getElementById('position-size-value').textContent = '10%';
          } else if (preset === 'moderate') {
            leverageSlider.value = 20;
            positionSlider.value = 25;
            document.getElementById('leverage-value').textContent = '20x';
            document.getElementById('position-size-value').textContent = '25%';
          } else if (preset === 'aggressive') {
            leverageSlider.value = 50;
            positionSlider.value = 50;
            document.getElementById('leverage-value').textContent = '50x';
            document.getElementById('position-size-value').textContent = '50%';
          }
        });
      });

      // ==================== SAVE FUNCTIONS ====================
      async function saveRiskSettings() {
        const settings = {
          max_leverage: parseInt(leverageSlider?.value || 20),
          max_position_size: parseInt(positionSlider?.value || 25),
          max_open_positions: parseInt(openPositionsSlider?.value || 5),
          daily_drawdown: parseInt(dailyDDSlider?.value || 5),
          weekly_drawdown: parseInt(weeklyDDSlider?.value || 10)
        };
        
        // Save to localStorage
        localStorage.setItem('riskSettings', JSON.stringify(settings));
        
        // Save to backend
        try {
          await fetch(`${API_BASE}/api/settings/risk`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(settings)
          });
        } catch (e) {
          console.log('[SETTINGS] Backend save failed, using local');
        }
        
        // Update global settings
        if (window.BastionSettings) {
          BastionSettings.current.risk = settings;
          BastionSettings.saveSettings();
        }
        
        showToast('Risk settings saved!', 'success');
      }

      async function saveProfile() {
        const profile = {
          display_name: document.getElementById('profile-name')?.value,
          email: document.getElementById('profile-email')?.value
        };
        localStorage.setItem('profile', JSON.stringify(profile));
        
        // Update sidebar
        if (profile.display_name) {
          document.getElementById('user-display-name').textContent = profile.display_name;
          document.getElementById('user-avatar').textContent = profile.display_name.charAt(0).toUpperCase();
          document.getElementById('profile-avatar').textContent = profile.display_name.charAt(0).toUpperCase();
        }
        
        // Save to backend
        try {
          await fetch(`${API_BASE}/api/settings/profile`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(profile)
          });
        } catch (e) {
          console.log('[PROFILE] Backend save failed');
        }
        
        showToast('Profile saved!', 'success');
      }

      function signOut() {
        if (confirm('Are you sure you want to sign out?')) {
          localStorage.clear();
          window.location.href = '/';
        }
      }

      // ==================== TELEGRAM INTEGRATION ====================
      let telegramVerifyInterval = null;
      let pendingTelegramCode = null;
      
      const telegramBtn = document.getElementById('telegram-connect');
      if (telegramBtn) {
        telegramBtn.addEventListener('click', connectTelegram);
      }
      
      async function connectTelegram() {
        const btn = document.getElementById('telegram-connect');
        btn.innerHTML = '<iconify-icon icon="solar:refresh-linear" class="animate-spin mr-1"></iconify-icon>Connecting...';
        btn.disabled = true;
        
        try {
          const res = await fetch(`${API_BASE}/api/alerts/telegram/connect`);
          const data = await res.json();
          
          if (data.success && data.connect_url) {
            // Open Telegram
            window.open(data.connect_url, '_blank');
            pendingTelegramCode = data.code;
            
            // Show verification modal
            showTelegramModal(data);
            
            // Start polling for verification
            telegramVerifyInterval = setInterval(checkTelegramVerification, 3000);
            
          } else if (data.setup_instructions) {
            // Bot not configured
            showToast('Telegram bot needs setup. Check console for instructions.', 'error');
            console.log('[TELEGRAM] Setup required:', data.setup_instructions);
          } else {
            showToast(data.error || 'Failed to connect Telegram', 'error');
          }
        } catch (e) {
          console.error('[TELEGRAM] Connect error:', e);
          showToast('Failed to connect Telegram', 'error');
        }
        
        btn.innerHTML = '<iconify-icon icon="solar:link-bold"></iconify-icon>Connect Telegram';
        btn.disabled = false;
      }
      
      function showTelegramModal(data) {
        const modal = document.createElement('div');
        modal.id = 'telegram-modal';
        modal.className = 'fixed inset-0 bg-black/80 flex items-center justify-center z-[200]';
        modal.innerHTML = `
          <div class="bg-[#0D0D0D] border border-zinc-800 rounded-lg p-6 max-w-md mx-4">
            <div class="flex items-center gap-3 mb-4">
              <iconify-icon icon="logos:telegram" class="text-3xl"></iconify-icon>
              <div>
                <div class="text-[14px] text-white font-bold">Connect Telegram</div>
                <div class="text-[10px] text-zinc-500">Waiting for connection...</div>
              </div>
            </div>
            
            <div class="bg-zinc-900 border border-zinc-800 rounded p-4 mb-4">
              <div class="text-[10px] text-zinc-400 mb-2">1. Click the button that opened or copy this link:</div>
              <div class="flex items-center gap-2 mb-3">
                <input type="text" readonly value="${data.connect_url}" class="flex-1 bg-zinc-800 border border-zinc-700 text-[10px] text-white px-2 py-1.5 rounded font-mono">
                <button onclick="navigator.clipboard.writeText('${data.connect_url}');showToast('Copied!','success')" class="px-2 py-1.5 bg-zinc-700 text-white text-[10px] rounded">Copy</button>
              </div>
              <div class="text-[10px] text-zinc-400 mb-2">2. Message @${data.bot_username} on Telegram</div>
              <div class="text-[10px] text-zinc-400">3. The bot will confirm when connected</div>
            </div>
            
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2 text-[10px] text-zinc-500">
                <iconify-icon icon="solar:refresh-linear" class="animate-spin"></iconify-icon>
                Waiting for connection...
              </div>
              <button onclick="closeTelegramModal()" class="px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-white text-[10px] rounded">Cancel</button>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      }
      
      function closeTelegramModal() {
        const modal = document.getElementById('telegram-modal');
        if (modal) modal.remove();
        if (telegramVerifyInterval) {
          clearInterval(telegramVerifyInterval);
          telegramVerifyInterval = null;
        }
        pendingTelegramCode = null;
      }
      
      async function checkTelegramVerification() {
        if (!pendingTelegramCode) return;
        
        try {
          const res = await fetch(`${API_BASE}/api/alerts/telegram/verify`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ code: pendingTelegramCode })
          });
          const data = await res.json();
          
          if (data.success) {
            closeTelegramModal();
            updateTelegramUI(true);
            showToast('Telegram connected successfully!', 'success');
            
            // Send test message
            await fetch(`${API_BASE}/api/alerts/test`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ channel: 'telegram' })
            });
          }
        } catch (e) {
          console.log('[TELEGRAM] Still waiting...');
        }
      }
      
      function updateTelegramUI(connected) {
        const btn = document.getElementById('telegram-connect');
        if (connected) {
          btn.innerHTML = '<iconify-icon icon="solar:check-circle-bold" class="mr-1"></iconify-icon>Connected';
          btn.className = 'px-3 py-1.5 bg-green-600 text-white text-[10px] rounded flex items-center gap-1';
          btn.onclick = () => showToast('Telegram already connected!', 'info');
        }
      }

      // ==================== APPEARANCE SETTINGS ====================
      
      // Save appearance settings
      function saveAppearanceSettings() {
        // Get current theme
        const activeTheme = document.querySelector('.theme-btn.border-crimson-600');
        const theme = activeTheme?.dataset.theme || 'crimson';
        
        // Get chart type
        const activeChartType = document.querySelector('.chart-type-btn.bg-crimson-600\\/20');
        const chartType = activeChartType?.dataset.type || 'candles';
        
        // Get colors
        const upColor = document.getElementById('up-color')?.value || '#22c55e';
        const downColor = document.getElementById('down-color')?.value || '#ef4444';
        
        // Get toggles
        const showVolume = document.querySelector('[data-setting="volume"]')?.classList.contains('toggle-on') ?? true;
        const showGrid = document.querySelector('[data-setting="grid"]')?.classList.contains('toggle-on') ?? true;
        const compactMode = document.querySelector('[data-setting="compact"]')?.classList.contains('toggle-on') ?? false;
        const scanlines = document.querySelector('[data-setting="scanlines"]')?.classList.contains('toggle-on') ?? true;
        const animations = document.querySelector('[data-setting="animations"]')?.classList.contains('toggle-on') ?? true;
        
        // Get font size
        const activeFontBtn = document.querySelector('.font-size-btn.bg-crimson-600\\/20');
        const fontSize = activeFontBtn?.textContent.toLowerCase() || 'medium';
        
        const settings = {
          theme,
          chartType,
          upColor,
          downColor,
          showVolume,
          showGrid,
          compactMode,
          scanlines,
          animations,
          fontSize
        };
        
        // Save to localStorage with a clear key
        localStorage.setItem('bastionAppearance', JSON.stringify(settings));
        
        // Also update BastionSettings if available
        if (window.BastionSettings) {
          BastionSettings.current = BastionSettings.current || {};
          BastionSettings.current.appearance = settings;
          BastionSettings.saveSettings();
          BastionSettings.applyTheme(theme);
        }
        
        // Save to backend
        fetch(`${API_BASE}/api/settings/appearance`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(settings)
        }).catch(e => console.log('[APPEARANCE] Backend save failed'));
        
        showToast('Appearance settings saved! Changes will apply across all pages.', 'success');
      }
      
      // Theme selection
      document.querySelectorAll('.theme-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const theme = btn.dataset.theme;
          
          // Update UI - remove active from all
          document.querySelectorAll('.theme-btn').forEach(b => {
            b.classList.remove('border-crimson-600');
            b.classList.add('border-zinc-700');
            const activeLabel = b.querySelector('.active-label');
            if (activeLabel) activeLabel.remove();
          });
          
          // Set this button as active
          btn.classList.add('border-crimson-600');
          btn.classList.remove('border-zinc-700');
          
          // Add active label
          if (!btn.querySelector('.active-label')) {
            const label = document.createElement('div');
            label.className = 'text-[8px] text-crimson-400 active-label';
            label.textContent = 'Active';
            btn.appendChild(label);
          }
          
          // Apply theme globally - this changes the background!
          if (window.BastionSettings) {
            BastionSettings.applyTheme(theme);
            BastionSettings.saveSettings();
          }
          
          showToast(`Background theme: ${theme}`, 'success');
        });
      });
      
      // Chart type selection
      document.querySelectorAll('.chart-type-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.chart-type-btn').forEach(b => {
            b.classList.remove('bg-crimson-600/20', 'border-crimson-600/50', 'text-crimson-400');
            b.classList.add('bg-zinc-800', 'border-zinc-700', 'text-zinc-400');
          });
          btn.classList.add('bg-crimson-600/20', 'border-crimson-600/50', 'text-crimson-400');
          btn.classList.remove('bg-zinc-800', 'border-zinc-700', 'text-zinc-400');
          
          if (window.BastionSettings) {
            BastionSettings.update('appearance', 'chartType', btn.dataset.type);
          }
        });
      });
      
      // Color pickers
      const upColorPicker = document.getElementById('up-color');
      const downColorPicker = document.getElementById('down-color');
      
      if (upColorPicker) {
        upColorPicker.addEventListener('change', (e) => {
          const color = e.target.value;
          upColorPicker.nextElementSibling.textContent = color;
          if (window.BastionSettings) {
            BastionSettings.update('appearance', 'upColor', color);
          }
        });
      }
      
      if (downColorPicker) {
        downColorPicker.addEventListener('change', (e) => {
          const color = e.target.value;
          downColorPicker.nextElementSibling.textContent = color;
          if (window.BastionSettings) {
            BastionSettings.update('appearance', 'downColor', color);
          }
        });
      }
      
      // Font size buttons
      document.querySelectorAll('.font-size-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.font-size-btn').forEach(b => {
            b.classList.remove('bg-crimson-600/20', 'border-crimson-600/50', 'text-crimson-400');
            b.classList.add('bg-zinc-800', 'border-zinc-700', 'text-zinc-400');
          });
          btn.classList.add('bg-crimson-600/20', 'border-crimson-600/50', 'text-crimson-400');
          btn.classList.remove('bg-zinc-800', 'border-zinc-700', 'text-zinc-400');
          
          const size = btn.textContent.toLowerCase();
          if (window.BastionSettings) {
            BastionSettings.update('appearance', 'fontSize', size);
          }
        });
      });

      // ==================== TOAST NOTIFICATIONS ====================
      function showToast(message, type = 'info') {
        const toast = document.createElement('div');
        toast.className = `fixed bottom-4 right-4 px-4 py-3 rounded-lg text-[11px] font-bold z-[100] transition-all transform translate-y-2 opacity-0 ${
          type === 'success' ? 'bg-green-600 text-white' : 
          type === 'error' ? 'bg-crimson-600 text-white' : 
          'bg-zinc-800 text-white'
        }`;
        toast.innerHTML = `
          <div class="flex items-center gap-2">
            <iconify-icon icon="${type === 'success' ? 'solar:check-circle-bold' : type === 'error' ? 'solar:close-circle-bold' : 'solar:info-circle-bold'}"></iconify-icon>
            ${message}
          </div>
        `;
        document.body.appendChild(toast);
        
        setTimeout(() => {
          toast.classList.remove('translate-y-2', 'opacity-0');
        }, 10);
        
        setTimeout(() => {
          toast.classList.add('translate-y-2', 'opacity-0');
          setTimeout(() => toast.remove(), 300);
        }, 3000);
      }

      // ==================== LOAD SAVED DATA ====================
      function loadSavedData() {
        // Load from global settings if available
        if (window.BastionSettings && BastionSettings.current) {
          const settings = BastionSettings.current;
          
          // Load appearance
          if (settings.appearance) {
            // Set theme button active
            const themeBtn = document.querySelector(`[data-theme="${settings.appearance.theme}"]`);
            if (themeBtn) {
              document.querySelectorAll('.theme-btn').forEach(b => {
                b.classList.remove('border-crimson-600');
                b.classList.add('border-zinc-700');
                const label = b.querySelector('.active-label');
                if (label) label.remove();
              });
              themeBtn.classList.add('border-crimson-600');
              themeBtn.classList.remove('border-zinc-700');
              if (!themeBtn.querySelector('.active-label')) {
                const label = document.createElement('div');
                label.className = 'text-[8px] text-crimson-400 active-label';
                label.textContent = 'Active';
                themeBtn.appendChild(label);
              }
            }
            
            // Set colors
            if (upColorPicker && settings.appearance.upColor) {
              upColorPicker.value = settings.appearance.upColor;
            }
            if (downColorPicker && settings.appearance.downColor) {
              downColorPicker.value = settings.appearance.downColor;
            }
          }
        }
        
        // Load profile
        const profile = JSON.parse(localStorage.getItem('profile') || '{}');
        if (profile.display_name || profile.name) {
          const name = profile.display_name || profile.name;
          document.getElementById('user-display-name').textContent = name;
          document.getElementById('user-avatar').textContent = name.charAt(0).toUpperCase();
          if (document.getElementById('profile-name')) {
            document.getElementById('profile-name').value = name;
          }
          if (document.getElementById('profile-avatar')) {
            document.getElementById('profile-avatar').textContent = name.charAt(0).toUpperCase();
          }
        }
        if (profile.email && document.getElementById('profile-email')) {
          document.getElementById('profile-email').value = profile.email;
        }
        
        // Load risk settings
        const risk = JSON.parse(localStorage.getItem('riskSettings') || '{}');
        if (risk.max_leverage || risk.maxLeverage) {
          const val = risk.max_leverage || risk.maxLeverage;
          if (leverageSlider) {
            leverageSlider.value = val;
            document.getElementById('leverage-value').textContent = val + 'x';
          }
        }
        if (risk.max_position_size || risk.maxPosition) {
          const val = risk.max_position_size || risk.maxPosition;
          if (positionSlider) {
            positionSlider.value = val;
            document.getElementById('position-size-value').textContent = val + '%';
          }
        }
      }

      // Load connected exchanges from API
      async function loadConnectedExchanges() {
        try {
          const res = await fetch(`${API_BASE}/api/exchange/list`);
          if (res.ok) {
            const data = await res.json();
            if (data.exchanges) {
              data.exchanges.forEach(e => addConnectedExchange(e.exchange));
            }
          }
        } catch (e) {
          console.log('[ACCOUNT] Could not load exchanges');
        }
      }
      
      // Check Telegram status
      async function checkTelegramStatus() {
        try {
          const res = await fetch(`${API_BASE}/api/settings/alerts`);
          if (res.ok) {
            const data = await res.json();
            if (data.settings?.telegram_connected) {
              updateTelegramUI(true);
            }
          }
        } catch (e) {
          // Ignore
        }
      }

      // Initialize
      loadSavedData();
      loadConnectedExchanges();
      checkTelegramStatus();
    </script>
</body>
</html>
